\section{Estendere una premisura ad una misura}
L'obiettivo ora è riuscire ad estendere una premisura definita su un semianello ad una misura su una \sigalg{}. Per fare questo il percorso sarà prima quello di estendere la premisura ad una misura esterna, per poi ridurre questa ad una misura canonica.


\begin{theorem}\label{RiduzionePreCaratheodory}
	Data $\mu:\mathcal P(X)\to \Rpiu$ una misura esterna, sia $\A\subseteq \mathcal P(X)$ l'insieme così definito:
	\begin{equation*}
		\A=\{E\in\mathcal P(X):\ \mu(A)=\mu(A\cap E)+\mu(A\setminus E)\ \forall A\in \mathcal P(X)\}
	\end{equation*}
	allora $\A$ è una \sigalg{}, detta \sigalg{} di Caratheodory, e $\mu$ ridotta su $\A$ è una misura completa.
\end{theorem}
\begin{proof}
	La dimostrazione procede in tre passi: prima mostriamo che $\A$ è un'algebra di insiemi, poi che è è una \sigalg{} e infine che $\mu$ è \sigadd{} e completa ridotta su $\A$.
	
	Il fatto che $\A$ sia stabile per complementare è ovvio per la definizione (che è simmetrica tra $E$ ed $E^c$).
	
	Fissati $A\in\mathcal P(X)$ generico ed $E,F\in\A$, applicando la sola definizione di $\A$ ed alcuni passaggi insiemistici si ricava:
	\begin{align*}
		\mu(A)\stackrel{F\in\A}{=}&\mu(A\cap F)+\mu(A\setminus F)\stackrel{E\in\A}{=}
		\mu(A\cap F)+\mu\left((A\setminus F)\cap E\right)+\mu\left((A\setminus F)\setminus E\right)\\
		=\hspace{0.4em}&\mu\left((A\cap (E\cup F))\cap F\right)+\mu\left((A\cap (E\cup F))\setminus F\right)+
		\mu\left(A\setminus(E\cup F)\right)\\
		\stackrel{F\in\A}{=}&\mu(A\cap (E\cup F))+\mu\left(A\setminus(E\cup F)\right)
	\end{align*}
	e visto che questo vale per ogni scelta di $A\in\mathcal P(X)$ abbiamo dimostrato che $\A$ è stabile per unione.
	
	Unendo quanto detto si ha facilmente che $\A$ è un'algebra di insiemi.
	
	Ora sia $(E_n)_{n\in\N}\subseteq \A$ una famiglia numerabile di insiemi ed $A\in\mathcal P(X)$ un generico sottoinsieme di $X$.
	
	Per la \sigsubadd[ità] di $\mu$ vale:
	\begin{equation}\label{DisuguaglianzaFacileCaratheodory}
		\mu(A)\le \mu\left(A\cap\bigcup_{n\in\N} E_n\right)+\mu\left(A\setminus\cap\bigcup_{n\in\N} E_n\right)
	\end{equation}
	Si vuole dimostrare che il $\le$ è in realtà un'uguaglianza. Se $\mu(A)=+\infty$ questo è ovvio, quindi tratteremo il caso in cui $\mu(A)<+\infty$. Chiamiamo $F_n=E_n\setminus \bigcup_{i<n} E_i$, ottenendo in maniera ovvia che gli $(F_n)_{n\in\N}$ sono a due a due disgiunti e che appartengono a $\A$ poiché quest'ultima è un'algebra.
	
	Per induzione è facile verificare, sfruttando unicamente il fatto che $F_n\in\A$ e $\mu(A)<+\infty$, che risulta:
	\begin{equation}\label{IdentitaDifferenzaCaratheodory}
		\mu\left(A\setminus \bigsqcup_{n\le m} F_n\right)=\mu(A)-\sum_{n\le m} \mu(A\cap F_n)
	\end{equation}
	e incidentalmente da questa formula si ha che la serie $\sum_{n\in\N}\mu(A\cap F_n)$ converge, visto che è a termini positivi e limitata (da $\mu(A)$).
	
	Per la \sigsubadd[ità] di $\mu$ vale:
	\begin{equation}\label{IntersezioneStimaCaratheodory}
		\mu\left(A\cap\bigcup_{n\in\N} E_n\right)=\mu\left(\bigsqcup_{n\in\N} A\cap F_n\right)\le
		\sum_{n\in\N} \mu(A\cap F_n)
	\end{equation}
	mentre, grazie alla monotonia e a \cref{IdentitaDifferenzaCaratheodory} otteniamo:
	\begin{equation}\label{DifferenzaStimaCaratheodory}
		\mu\left(A\setminus\bigcup_{n\in\N} E_n\right) = \mu\left(A\setminus\bigsqcup_{n\in\N} F_n\right) \le \mu\left(A\setminus\bigsqcup_{n\le m} F_n\right) = 
		\mu(A)-\sum_{n\le m}\mu(A\cap F_n)
	\end{equation}
	
	Ora unendo \cref{IntersezioneStimaCaratheodory,DifferenzaStimaCaratheodory} giungiamo ad avere che, per ogni $m\in\mathbb{N}$:
	\begin{equation*}
		\mu\left(A\cap\bigcup_{n\in\N} E_n\right)+\mu\left(A\setminus\bigcup_{n\in\N} E_n\right)\le
		\mu(A)+\sum_{m\le n}\mu(A\cap F_n) 
	\end{equation*}
	ma per la convergenza di $\sum_{n\in \N}\mu(A\cap F_n)$, estraendo l'$\inf$ da entrambe le parti finalmente arriviamo a:
	\begin{equation*}
		\mu\left(A\cap\bigcup_{n\in\N} E_n\right)+\mu\left(A\setminus\bigcup_{n\in\N} E_n\right)\le
		\mu(A)
	\end{equation*}
	che unita a \cref{DisuguaglianzaFacileCaratheodory} ci assicura che vale l'identità tra i membri e, visto che ciò vale indipendentemente dalla scelta di $A\in\mathcal P(X)$, risulta $\bigcup_{n\in\N}E_n\in\A$ che equivale a dire che $\A$ è una \sigalg{}.
	
	Dimostrare che $\mu$ è \sigadd{} su $\A$ è ora molto facile.
	Consideriamo $(E_n)_{n\in\N}\subset \A$ una famiglia numerabile di insiemi \emph{disgiunti}. Per facile induzione si ha che:
	\begin{equation*}
		\mu\left(\bigsqcup_{n\le m}E_n\right)=\sum_{n\le m} \mu(E_n)
	\end{equation*}
	e applicando questa e la monotonia di $\mu$ risulta:
	\begin{equation*}
		\sum_{n\le m} \mu(E_n)=\mu\left(\bigsqcup_{n\le m}E_n\right)\le
		\mu\left(\bigsqcup_{n\in\N}E_n\right)\le \sum_{n\in\N} \mu(E_n)
	\end{equation*}
	e questa doppia disuguaglianza, per la definizione delle serie a termini positivi, implica che tutte le disuguaglianze sono identità. Ma allora questo dimostra che $\mu$ è \sigadd{} su $\A$.
	
	Infine per dimostrare la completezza di $\mu|_{\A}$ basta mostrare che dato $E\in\mathcal P(X)$ trascurabile, vale $E\in\A$ (questo è sufficiente a mostrare la completezza, visto che per monotonia i sottinsiemi di un trascurabile sono a loro volta trascurabili).
	
	Fissato un generico $A\in\mathcal P(X)$, risulta per la monotonia di $\mu$:
	\begin{equation*}
		\mu(A\cap N)+\mu(A\setminus N)\le \mu(N)+\mu(A)=\mu(A)
	\end{equation*}
	che, unita alla \sigsubadd[ità] di $\mu$ mi assicura
	\begin{equation*}
		\mu(A)=\mu(A\cap N)+\mu(A\setminus N)
	\end{equation*}
	che è proprio la condizione di appartenenza ad $\A$.
\end{proof}

\begin{proposition}\label{MisuraEsternaDiPremisura}
	Dato $(X,\S,\mu)$ uno spazio di misura elementare si consideri la funzione che associa ad ogni sottoinsieme l'estremo inferiore delle misure dei ricoprimenti, cioè $\mu^*:\mathcal P(X)\to\Rpiu$ definita come 
	\begin{equation*}
		\mu^*(A)=\inf\left\{\sum_{n\in\N} A_n\ |\ (A_n)_{n\in\N}\subseteq\S\ \wedge
		\ A\subseteq\bigcup_{n\in\N}A_n\right\}
	\end{equation*}
	Allora $\mu^*$ è una misura esterna che estende $\mu$ (cioè $\mu^*|_\S=\mu$) ed inoltre $\S$ appartiene alla relativa \sigalg{} di Caratheodory (come definita in \cref{RiduzionePreCaratheodory}).
\end{proposition}
\begin{proof}
	Per ottenere che $\mu^*$ è una misura esterna basta verificare le proprietà che deve rispettare.
	Ovviamente, poiché $\mu(\emptyset)=0$, vale $\mu^*(\emptyset)=0$. 
	Inoltre, ancora facilmente, $\mu^*$ è monotona, visto che se $A\subseteq B$ un ricoprimento di $B$ ricopre anche $A$.
	E infine è anche \sigsubadd{} visto che l'unione di ricoprimenti (che risulta ancora un ricoprimento numerabile) è un ricoprimento dell'unione.
	
	Dato $S\in\S$ vale ovviamente $\mu*(S)\le\mu(S)$, poiché $S$ si ricopre da solo. Per dimostrare la disuguaglianza opposta consideriamo $(S_n)_{n\in\N}\in \S$ un ricoprimento di $S$
	
	Ora perciò resta da dimostrare che se $E\subseteq \S$ allora per ogni $A\in\mathcal P(X)$ risulta:
	\begin{equation}\label{MisuraEsternaDisDifficile}
		\mu^*(A) \ge \mu^*(A\cap E)+\mu^*(A\setminus E)
	\end{equation}
	Questo è sufficiente ad avere che $\S$ è contenuto nella \sigalg{} di Caratheodory poiché l'altra disuguaglianza è assicurata dalla \sigsubadd[ità].
	
	Dato $(A_n)_{n\in\N}\subseteq\S$ un ricoprimento di $A$, chiamiamo $B_n=A_n\cap E$ e $C_n=A_n\setminus E$. Ovviamente $(B_n)_{n\in\N},(C_n)_{n\in\N}$ ricoprono rispettivamente $A\cap E,A\setminus E$. Poiché $\S$ è un \semiring{} riusciamo però a trovare $(B'^n_i)_{i\in\N},(C'^n_i)_{i\in\N} \subseteq \S$ tali che $B_n=\bigsqcup_{i\in\N}B'^n_i$ e analogo risultato per $C_n$. Quindi $(B'^n_i)_{n,i\in\N}, (C'^n_i)_{n,i\in\N}$ risultano ricoprimenti con elementi di $\S$ di $A\cap E,A\setminus E$ rispettivamente.
	Ora, sfruttando non più della sola \sigadd[ità] di $\mu$ concludo:
	\begin{align*}
		\sum_{n\in\N}\mu(A_n)=\sum_{n\in\N} \mu(B_n)+\mu(C_n)&=
		\sum_{n\in\N}\sum_{i\in\N}\mu(B'^n_i)+\mu(C'^n_i)\\
		&=
		\sum_{n,i\in\N}\mu(B'^n_i)+\sum_{n,i\in\N}\mu(C'^n_i)\ge \mu(A\cap E)+\mu(A\setminus E)
	\end{align*}
	ma questo implica facilmente \cref{MisuraEsternaDisDifficile} estraendo l'estremo inferiore a entrambi i membri sui ricoprimenti di $A$.
\end{proof}

\begin{theorem}[Estensione di Caratheodory]\label{EstensioneCaratheodory}
	Dato $(X,\S,\mu)$ uno spazio di misura elementare esiste una \sigalg{} $\A$ e una funzione $\mu':\A\to\Rpiu$ tali che $\S\subseteq \A$, $\mu'$ estende la premisura $\mu$ e $(X,\A,\mu')$ è uno spazio di misura completo.
\end{theorem}
\begin{proof}
	Consideriamo la misura esterna $\mu^*:\mathcal P(X)\to\Rpiu$ definita nell'enunciato di \cref{MisuraEsternaDiPremisura}. Sempre \cref{MisuraEsternaDiPremisura} ci assicura che questa è un'estensione di $\mu$.
	
	Possiamo ora ridurre $\mu^*$ grazie al \cref{RiduzionePreCaratheodory} ad una misura completa $\mu':\A\to\Rpiu$ dove $\A$ è la \sigalg{} di Caratheodory. 
	
	Ma come dimostrato in \cref{MisuraEsternaDiPremisura} $\S\subseteq\A$ e inoltre vale $\mu'|_\S=\mu^*|_\S=\mu$, perciò lo spazio $(X,\A,\mu')$ rispetta tutte le richieste dell'enunciato.
\end{proof}


\begin{proposition}
	Dato $(X,\S,\mu)$ una spazio di misura elementare $\sigma$-finito, sia $\mu^*$ la misura esterna associata a $\mu$ (come definita nell'enunciato di \cref{MisuraEsternaDiPremisura}) e $\A$ la \sigalg{} di Caratheodory (la cui esistenza mi è assicurata dal \cref{EstensioneCaratheodory}) con la relativa estensione della misura $\mu':\A\to\Rpiu$.
	
	Scelto $A\in\mathcal P(X)$, le seguenti affermazioni sono equivalenti:
	\begin{enumerate}[label=(\arabic*),ref=(\arabic*)]
		\item $A\in\A$ cioè l'insieme è un misurabile (secondo Caratheodory).\label{MisurabileEquivalenze}
		\item Fissato $\epsilon>0$ esiste $S\in\sqcup\S$ che contiene $A$ e tale che $\mu^*(S\setminus A)<\epsilon$.\label{UnioniDaFuoriEquivalenze}
		\item Esiste $B\in\sigma A(S)$ che $B$ che contiene $A$ e tale che $\mu^*(B\setminus A)=0$.\label{SigmaDaFuoriEquivalenze}
		\item Fissato $\epsilon>0$ esiste $S$ contenuto in $A$ tale che $S^c\in\sqcup\S$  e $\mu^*(A\setminus S)<\epsilon$.\label{UnioniDaDentroEquivalenze}
		\item Esiste $B\in\sigma A(S)$ che è contenuto in $A$ e tale che $\mu^*(A\setminus B)=0$.\label{SigmaDaDentroEquivalenze}
	\end{enumerate}
\end{proposition}
\begin{proof}
	Dimostriamo innanzitutto la catena di implicazioni
	$\text{\ref{MisurabileEquivalenze}}\implies
	\text{\ref{UnioniDaFuoriEquivalenze}}\implies
	\text{\ref{SigmaDaFuoriEquivalenze}}\implies
	\text{\ref{MisurabileEquivalenze}}$.
	\newcommand{\ImplicationProof}[2]{$\text{\ref{#1}}\implies\text{\ref{#2}}$}% X => Y
	\begin{description}
		\item[\ImplicationProof{MisurabileEquivalenze}{UnioniDaFuoriEquivalenze}] Sia $A$ misurabile e $(X_n)_{n\in\N}\subseteq \S$ una partizione numerabile di $X$ tale che $\mu(A_n)<+\infty$ (questa esiste poichè $\mu$ è \sigfin{} e ogni unione numerabile di elementi in $\S$ è un unione disgiunta, visto che $\sqcup\S$ è chiuso per unioni numerabili come mostrato in \cref{UnioneDisgiuntaQuasiAlgebra}).
		
		Definiamo $A_n=A\cap X_n$. Gli $A_n$ sono misurabili, perchè intersezioni di misurabili, e hanno misura finita dato che la misura è monotona.
		
		Sia $\epsilon>0$ fissato.
		
		Dato $n\in\N$ allora $\mu'(A_n)=\mu^*(A_n)$, ma per la definizione di $\mu^*$ questo implica che esiste $S_n\in\sqcup \S$ tale che $A_n\subseteq S_n$ e tale che valga:
		\begin{equation*}
			\mu^*(A_n)\le \mu^*(S_n) \le \mu^*(A_n)+\frac\epsilon{2^n}\implies
			0\le \mu^*(S_n)-\mu^*(A_n)\le \frac\epsilon{2^n}
		\end{equation*}
		dove nell'implicazione abbiamo sfruttato $\mu^*(A_n)=\mu'(A_n)<+\infty$.
		Infine dal fatto che $S_n,A_n$ sono misurabili, per l'addittività della misura, ricaviamo:
		\begin{equation}\label{DifficileFreccia12Misurabili}
			0\le \mu'(S_n\setminus A_n) \le \frac\epsilon{2^n} \implies \mu^*(S_n\setminus A_n)\le \frac\epsilon{2^n}
		\end{equation}
		
		Ora consideriamo $S=\bigcup_{n\in\N}S_n$, che appartiene ancora a $\sqcup\S$ poichè questo è chiuso per unione numerabile come dimostrato in \cref{UnioneDisgiuntaQuasiAlgebra}. Si ha $A\subseteq S$ e per la subaddittività della misura esterna  $\mu^*$, sfruttando \cref{DifficileFreccia12Misurabili}, si ottiene:
		\begin{equation*}
			\mu^*(S\setminus A)=\mu^*\left(\bigcup_{n\in\N}S_n\setminus A_n\right)\le
			\sum_{n\in\N}\mu^*(S_n\setminus A_n)\le\sum_{n\in\N}\frac\epsilon{2^n}\le \epsilon
		\end{equation*}
		e questo conclude, visto che $S$ soddisfa tutte le richieste dell'enunciato.
		\item[\ImplicationProof{UnioniDaFuoriEquivalenze}{SigmaDaFuoriEquivalenze}] L'ipotesi ci assicura l'esistenza di $(S_n)_{n\in\N}\subseteq \sqcup \S$ tali che $A\subseteq S_n$ e $\mu^*(S_n\setminus A)<\frac1n$.
		
		Definiamo $B=\cap_{n\in\N}S_n$, che appartiene a $\sigma A(\S)$ poichè generato a partire da $\S$ con sole unioni e intersezioni numerabili. Ovviamente vale $A\subseteq B$.
		
		Infine risulta vera la seguente:
		\begin{equation*}
			\forall n\in\N:\ B\subseteq B_n\implies B\setminus A\subseteq B_n\setminus A\implies \mu^*(B\setminus A)\le \mu^*(B_n\setminus A)\le \frac1n
		\end{equation*}
		e perciò $\mu^*(B\setminus A)=0$ e questo dimostra l'implicazione cercata.
		\item[\ImplicationProof{SigmaDaFuoriEquivalenze}{MisurabileEquivalenze}] Per ipotesi esiste $B\in\sigma A(\S)$ che contiene $A$ e tale che $\mu^*(B\setminus A)=0$.
		
		Poichè $\A$ è una \sigalg{} contenente $\S$ e $B\in\sigma A(\S)$, deve essere $B\in\A$. 
		Inoltre $\mu':\A\to\Rpiu$ è una misura completa, come visto nel \cref{RiduzionePreCaratheodory}, e inoltre i trascurabili secondo $\mu^*$ risultano essere proprio i trascurabili secondo $\mu'$ (come visto nella dimostrazione di \cref{RiduzionePreCaratheodory}) quindi anche $B\setminus A\in A$ in quanto è un trascurabile e la misura è completa. 
		
		Di conseguenza, visto che $\A$ è una \sigalg, otteniamo che $A=B\setminus (B\setminus A)$ è misurabile in quanto differenza di misurabili. Perciò $A\in\A$ dimostrando l'implicazione.
	\end{description}
	
	Infine basta vedere, sfruttando il passaggio al complementare, che risultano $\text{\ref{UnioniDaFuoriEquivalenze}}\iff\text{\ref{UnioniDaDentroEquivalenze}}$ e $\text{\ref{SigmaDaFuoriEquivalenze}}\iff\text{\ref{SigmaDaDentroEquivalenze}}$ e questo chiude la dimostrazione.
\end{proof}
