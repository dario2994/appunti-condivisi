\section{Integrazione secondo Lebesgue}
In questa sezione definiremo la nozione di integrale secondo Lebesgue e dimostreremo alcuni risultati introduttivi. In particolare definiremo inizialmente l'integrale di funzioni misurabili positive per poi estenderlo facilmente alle funzioni misurabili che hanno integrale del loro valore assoluto finito. Chiameremo queste ultime funzioni integrabili.

\begin{remark}
	Indicheremo l'integrale di $f$ su una spazio di misura $(X,\A,\mu)$ con 
	\begin{equation*}
		\int_X f(x) \de \mu(x)=\int_X f \de \mu=\int f \de \mu=\int f
	\end{equation*}
	dove si applicheranno le varie omissioni quando saranno ovvi la variabile di integrazione $x$, lo spazio di misura $X$ o la misura $\mu$.
\end{remark}

\begin{definition}\label{def:IntegraleSemplici}
	Sia $\simp$ una funzione misurabile, semplice e positiva, definita sullo spazio di misura $(X,\A,\mu)$. Definiamo l'integrale di Lebesgue della funzione il valore
	\begin{equation*}
		\int_X \simp d \mu = \sum_{k=1}^n c_k\mu(E_k)
	\end{equation*}
	dove $c_k\in \R$ e $E_k \in \A$ sono tali che $\simp=\sum_{k=1}^nc_k\chi(E_k)$.
\end{definition}

\begin{remark}\label{BuonaDefIntSemp}
	Quella appena enunciata è una buona definizione, cioè non dipende dalla scelta dei $c_k$ e degli $E_k$.
\end{remark}
\begin{proof}
	Consideriamo innanzitutto dei $c_k\in \R$ e degli $E_k\in \A$ tali che $\simp=\sum_{k=1}^nc_k\chi(E_k)$ e definiamo per ogni $\alpha\subseteq\{1,2,\dots,n\}$:
	\begin{equation*}
		\begin{cases}
			E_\alpha=\bigcap_{k\in\alpha}E_k\setminus \bigcup_{k\not\in \alpha} E_k\\
			c_\alpha=\sum_{k\in\alpha} c_k
		\end{cases}
	\end{equation*}
	D'ora in poi nelle sommatorie sottointenderemo l'insieme su cui cicla $\alpha$, cioè $\mathcal{P}(\{1,2,\dots,n\})$.
	
	Innanzitutto gli $E_\alpha$ sono ancora insiemi misurabili in quanto $\A$ è una \sigalg{} e sono insiemi disgiunti, inoltre vale facilmente che:
	\begin{equation*}
		\simp=\sum_{k=1}^nc_k\chi(E_k)=\sum_{k=1}^nc_k\sum_{\alpha\ni k}\chi(E_\alpha)=\sum_\alpha \chi(E_\alpha)\sum_{k\in\alpha}c_k=\sum_\alpha c_\alpha\chi(E_\alpha)
	\end{equation*}
	dove ho utilizzato che $E_k=\cup_{\alpha\ni k} E_\alpha$.

	Vogliamo dimostrare che $\sum_{k=1}^nc_k\mu(E_k)=\sum_{\alpha}c_\alpha\mu(E_\alpha)$, ma per l'additività di $\mu$ su insiemi disgiunti otteniamo:
	\begin{equation}\label{RaffinamentoIntegrale}
		\sum_\alpha c_\alpha\mu(E_\alpha)=\sum_\alpha \sum_{k\in\alpha}c_k\mu(E_\alpha)=\sum_{k=1}^n c_k\sum_{\alpha \ni k} \mu(E_\alpha)=\sum_{k=1}^n c_k \mu(E_k)
	\end{equation}
	che è proprio quello che volevamo.
	
	Consideriamo ora $c_k, b_k\in\R$ ed $E_k,F_k\in\A$ tali che $\simp=\sum_{k=1}^nc_k\chi(E_k)=\sum_{k=1}^mb_k\chi(F_k)$. A meno di aggiungere dei termini ad entrambe le sommatorie possiamo supporre $E_k=F_k$ e $n=m$, da cui $\simp=\sum_{k=1}^nc_k\chi(E_k)=\sum_{k=1}^nb_k\chi(E_k)$. Applichiamo la costruzione di prima e otteniamo:
	\begin{equation*}
		\begin{cases}
			E_\alpha=\bigcap_{k\in\alpha}E_k\setminus \bigcup_{k\not\in \alpha} E_k\\
			c_\alpha=\sum_{k\in\alpha} c_k\\
			b_\alpha=\sum_{k\in\alpha} b_k
		\end{cases}
	\end{equation*}
	da cui ricaviamo per quanto detto precedentemente che:
	\begin{equation}
		\sum_\alpha c_\alpha\chi(E_\alpha)=\sum_{k=1}^nc_k\chi(E_k)=\simp=\sum_{k=1}^nb_k\chi(E_k)=\sum_\alpha b_\alpha\chi(E_\alpha)
	\end{equation}
	che implica facilmente che $c_\alpha=b_\alpha$ per ogni $\alpha$, poichè gli $E_\alpha$ sono disgiunti.
	
	Infine da quest'ultima uguaglianza e dalla \cref{RaffinamentoIntegrale} otteniamo proprio quello che volevamo, in quanto:
	\begin{equation*}
		\sum_{k=1}^n c_k \mu(E_k)=\sum_\alpha c_\alpha\mu(E_\alpha)=\sum_\alpha b_\alpha\mu(E_\alpha)=\sum_{k=1}^n b_k \mu(E_k)
	\end{equation*}
\end{proof}

\begin{proposition}\label{prop:IntegraleSemplici}
	Date $\simp_1,\simp_2$ funzioni semplici e positive su $(X,\A,\mu)$ e dati $a,b$ reali non negativi valgono:
	\begin{enumerate}
		\item $\int (a\simp_1+b\simp_2)\de\mu=a\int \simp_1\de\mu+b\int \simp_2\de\mu$ \label{PIS:add}
		\item $\simp_1\le \simp_2\Longrightarrow \int \simp_1\de\mu\le \int \simp_2\de\mu$ \label{PIS:mono}
	\end{enumerate}
\end{proposition}
\begin{proof}
	Seguono entrambe facilmente dalla definizione di integrale di funzioni semplici e dalla \cref{BuonaDefIntSemp}.
\end{proof}

\begin{proposition}\label{IntegraleSempliciSpezzato}
	Siano $X_1,X_2,\dots,X_k$ misurabili e disgiunti tali che $X=\cup_{m=1}^kX_m$ e sia $\simp$ una funzione semplice e positiva, allora
	\begin{equation*}
		\int_X \simp \de \mu=\sum_{m=1}^k \int_{X_m}\simp\de \mu
	\end{equation*}
\end{proposition}
\begin{proof}
	Per ogni $X_m$ siano $c_{m,i}\in\R$ e $E_{m,i}\in\A$, per $i=1,2,\dots,n_m$, tali che 
	\begin{equation*}
		\simp|_{X_m}=\sum_{i=1}^{n_m}c_{m,i}\chi_{E_{m,i}}
	\end{equation*}
	allora vale
	\begin{equation*}
		\simp=\sum_{m=1}^k\sum_{i=1}^{n_m}c_{m,i}\chi_{E_{m,i}}
	\end{equation*}
	da cui quindi ottengo facilmente
	\begin{equation*}
		\int_X \simp \de \mu=\sum_{m=1}^k\sum_{i=1}^{n_m}c_{m,i}\mu(E_{m,i})=\sum_{m=1}^k\int_{X_m}\simp\de \mu
	\end{equation*}

\end{proof}



\begin{definition}\label{def:IntegralePositive}
	Sia $f$ una funzione misurabile positiva su $(X,\A,\mu)$, allora definiamo l'integrale di $f$ come
	\begin{equation*}
		\int_Xf\de\mu=\sup_{n\in\N}\left\{\int_X\simp\de \mu:\ 0\le \simp\le f\ \wedge\ \simp \text{ semplice}\right\}
	\end{equation*}
\end{definition}

\begin{proposition} \label{DefinizioneEquivalenteIntegralePositive}
	Data una successione crescente di funzioni semplici e positive $(\simp_n)$ tali che convergono puntualmente a $f$, vale 
	\begin{equation*}
		\int_X f\de\mu=\sup_{n\in\N}\left\{\int_X\simp_n\de\mu\right\}
	\end{equation*}
\end{proposition}
\begin{proof}
	Dimostriamo innanzitutto che dato un insieme $Y\subseteq X$ misurabile tale che $f\ge a$ in $Y$, allora vale $\sup_{n\in\N}\left\{\int_Y\simp_n\de\mu\right\}\ge a\mu(Y)$.
	
	Dato $\epsilon>0$ sia $A_n=\{\simp_n\ge a-\epsilon\}\cap Y$. Allora abbiamo che gli $A_n$ sono misurabili, vale $A_n\subseteq A_{n+1}$, perchè le $\simp_n$ sono crescenti, e $\cup_nA_n=Y$. Inoltre $\simp_n\ge (a-\epsilon)\chi_{A_n}$ in $Y$ per la definizione stessa di $A_n$. Perciò per \cref{prop:IntegraleSemplici} ho che
	\begin{equation*}
		\int_Y\simp_n\de\mu\ge(a-\epsilon)\mu(A_n)
	\end{equation*}
	da cui passando al limite su $n$ ed utilizzando che $\lim_{n\to\infty}\int_Y\simp_n\de\mu=\sup_{n\in\N}\int_Y\simp_n\de\mu$, otteniamo
	\begin{equation*}
		\sup_{n\in\N}\left\{\int_Y\simp_n\de\mu\right\}\ge(a-\epsilon)\lim_{n\to\infty}\mu(A_n)=(a-\epsilon)\mu(Y)
	\end{equation*}
	dove in particolare nell'ultima uguaglianza abbiamo utilizzato \cref{LimiteMonotonoCrescenteMisura}. Poichè in quest'ultima relazione $\epsilon$ è arbitrario otteniamo quindi
	\begin{equation*}
		\sup_{n\in\N}\left\{\int_Y\simp_n\de\mu\right\}\ge a\mu(Y)
	\end{equation*}

	Consideriamo ora una qualsiasi funzione semplice $\simp$ tale che $0\le \simp\le f$. Per facile conseguenza della definizione di funzione semplice, esistono $k$ sottoinsiemi misurabili disgiunti di $X$, che chiamiamo $X_1,\dots,X_k$, tali che $\cup_{m=1}^kX_m=X$ e $\simp|_{X_m}$ è costante per ogni $m=1,\dots,k$.
	
	Per quanto dimostrato precedentemente abbiamo che $\sup_{n\in\N}\left\{\int_{X_m}\simp_n\de\mu\right\}\ge a_m\mu(X_m)$ per ogni $m=1,\dots,k$, dove $a_m=\simp|_{X_m}$. Unendo questo risultato a \cref{IntegraleSempliciSpezzato} e ricordando che i $\sup$ sono in realtà dei limiti, otteniamo:
	\begin{equation*}
		\sup_{n\in\N}\left\{\int_X\simp_n\de\mu\right\}=\sup_{n\in\N}\left\{\sum_{m=1}^k \int_{X_m}\simp_n\de \mu\right\}=\sum_{m=1}^k\sup_{n\in\N}\left\{ \int_{X_m}\simp_n\de \mu\right\}\ge \sum_{m=1}^ka_m\mu(X_m)=\int_X\simp\de\mu
	\end{equation*}
	Passando ora all'estremo superiore per $0\le \simp \le f$ otteniamo proprio:
	\begin{equation*}
		\sup_{n\in\N}\left\{\int_X\simp_n\de\mu\right\}\ge \int_X f \de\mu\Longrightarrow \sup_{n\in\N}\left\{\int_X\simp_n\de\mu\right\}= \int_X f\de\mu
	\end{equation*}
	dove l'ultima implicazione è ovvia perchè banalmente $\sup_{n\in\N}\left\{\int_X\simp_n\de\mu\right\}\le \int_X f\de\mu$.
\end{proof}

\begin{proposition}\label{prop:IntegralePositive}
	Date $f,g$ funzioni misurabili positive su $(X,\A,\mu)$ e dati $a,b$ reali non negativi valgono:
	\begin{enumerate}
		\item $\int (af+bg)\de\mu=a\int f\de\mu+b\int g\de\mu$ \label{PIP:add}
		\item $f\le g\Longrightarrow \int f\de\mu\le \int g\de\mu$ \label{PIP:mono}
	\end{enumerate}
\end{proposition}
\begin{proof}
	\begin{description}
		\item[\ref{PIP:add}] Siano $(\simp_n^f)_{n\in\N}$ e $(\simp_n^g)_{n\in\N}$ due successioni crescenti di funzioni semplici e positive convergenti rispettivamente ad $f$ e a $g$. Vale facilmente che la successione crescente di funzioni semplici e positive $(a\simp_n^f+b\simp_n^g)_{n\in\N}$ converge a $af+bg$. Allora per la \cref{DefinizioneEquivalenteIntegralePositive} e per \cref{prop:IntegraleSemplici} abbiamo che
		\begin{equation*}
		\begin{split}
			a\int f\de\mu+b\int g\de\mu&=a\sup_{n\in\N}\int \simp_n^f\de\mu+b\sup_{n\in\N}\int \simp_n^g\de\mu \\
			&=\sup_{n\in\N}\int (a\simp_n^f+b\simp_n^g)\de\mu=\int (af+bg)\de\mu
		\end{split}
		\end{equation*}
		
		\item[\ref{PIP:mono}] Segue facilmente dalla \cref{def:IntegralePositive}, in quanto se $\simp$ è una funzione semplice e positiva minore o uguale a $f$ è anche minore o uguale a $g$, perciò
		\begin{equation*}
		\int f\de\mu=\sup_{n\in\N}\left\{\int\simp\de \mu:\ 0\le \simp\le f\le g\ \wedge\ \simp \text{ semplice}\right\}\le \int g\de\mu
	\end{equation*}
	\end{description}
\end{proof}

\begin{theorem}[Beppo Levi]\label{thm:BeppoLevi}
	Sia $(f_n)$ una successione crescente di funzioni misurabili positive convergenti puntualmente ad una funzione $f$, allora $\int_Xf\de\mu=\lim_{n\to\infty}\int_Xf_n\de\mu$.
\end{theorem}

\begin{proof}
	Innanzitutto notiamo che ha senso parlare dell'integrale di $f$, perchè essendo $f(x)=\sup_{n\in\N}f_n(x)$ per ogni $x\in X$, per la \cref{SupMis} $f$ è una funzione misurabile e positiva.
	
	Per \cref{LimSemCrescMis}, per ogni $n$ esiste una successione crescente di funzioni semplici positive $(\simp_{n,k})_{k\in\N}$ che converge puntalmente a $f_n$. In particolare utilizzando la stessa costruzione di \cref{LimSemCrescMis} notiamo che è possibile scegliere le $\simp_{n,k}$ crescenti anche rispetto a $n$. Allora la successione $(\simp_{n,n})$ converge puntalmente a $f$. Di conseguenza otteniamo proprio
	\begin{equation*}
		\int_X f\de\mu=\sup_{n\in\N}\int_X\simp_{n,n}\de\mu=\sup_{k,n\in\N}\int_X \simp_{n,k}\de\mu=\sup_{n\in\N}\int_X f_n\de\mu=\lim_{n\to\infty}\int_Xf_n\de\mu
	\end{equation*}
\end{proof}


\begin{lemma}[Fatou] \label{lem:Fatou}
	Sia $(f_n)$ una successione di funzioni misurabili positive, allora 
	\begin{equation*}
		\int_X\left(\liminf_{n\to\infty}f_n(x)\right)\de\mu\le \liminf_{n\to\infty}\int_Xf_n\de\mu
	\end{equation*}
\end{lemma}

\begin{proof}
	Applichiamo il \cref{thm:BeppoLevi} alla successione di funzioni crescenti $(\inf_{k\ge n}f_k(x))_{n\in\N}$ che converge puntalmente alla funzione $\liminf_{n\to\infty}f_n(x)$ e otteniamo
	\begin{equation*}
		\int_X\left(\liminf_{n\to\infty}f_n\right)\de\mu=\int_X \sup_{n\in\N}\left\{\inf_{k\ge n}f_k\right\}\de\mu=\sup_{n\in\N}\int_X \inf_{k\ge n}f_k\de\mu\le \liminf_{n\to\infty}\int_Xf_n\de\mu
	\end{equation*}
	dove l'ultima disuguaglianza è vera per la monotonia dell'integrale. Infatti per \cref{prop:IntegralePositive}, ho che
	\begin{equation*}
		\int_X \inf_{k\ge n}f_k\de\mu\le \int_Xf_k\de\mu \ \forall k\ge n \Longrightarrow \int_X \inf_{k\ge n}f_k\de\mu\le \inf_{k\ge n}\int_Xf_k\de\mu
	\end{equation*}
\end{proof}

\begin{definition}
	Una funzione misurabile $f:X\to\Rbar$ con $(X,\A,\mu)$ spazio di misura si dice integrabile se 
	\begin{equation*}
		\LNorm f=\int_X |f|\de\mu
	\end{equation*}
	ha valore finito.
	
% 	La quantità $\LNorm f$ è detta norma integrale, anche se non è effettivamente una norma.
\end{definition}

\begin{definition}\label{def:IntegraleIntegrabili}
	Data una funzione integrabile definiamo il suo integrale come
	\begin{equation*}
		\int_X f\de\mu=\int_Xf_+\de\mu-\int_Xf_-\de\mu
	\end{equation*}
	dove $f_+=\max\{0,f\}$ e $f_-=\max\{0,-f\}$.
\end{definition}

\begin{remark}
	Notiamo in particolare che le funzioni $f_+$ ed $f_-$, oltre ad essere positive, sono anche integrabili.
\end{remark}

\begin{lemma}\label{DefinizioneEquivalenteIntegraleIntegrabili}
	Data una funzione integrabile $f$ e date due funzioni $g,h$ integrabili e positive tali $f=g-h$, allora
	\begin{equation*}
		\int_X f\de\mu=\int_Xg\de\mu-\int_Xh\de\mu
	\end{equation*}
\end{lemma}
\begin{proof}
	Poichè $f_++h=f_-+g$, per la \cref{prop:IntegralePositive} e ricordando che gli integrali di $f_+,f_-,g,h$ sono finiti, otteniamo
	\begin{gather*}
		\int_X f_+\de\mu+\int_X h\de\mu=\int_X f_-\de\mu+\int_X g\de\mu \\
		\Longrightarrow \int f\de\mu=\int_Xf_+\de\mu-\int_Xf_-\de\mu=\int_Xg\de\mu-\int_Xh\de\mu
	\end{gather*}

\end{proof}

\begin{proposition}\label{prop:IntegraleIntegrabili}
	Date $f,g$ funzioni integrabili su $(X,\A,\mu)$ e dati $a,b$ reali valgono:
	\begin{enumerate}
		\item $\int (af+bg)\de\mu=a\int f\de\mu+b\int g\de\mu$ \label{PII:add}
		\item $f\le g\Longrightarrow \int f\de\mu\le \int g\de\mu$ \label{PII:mono}
	\end{enumerate}
\end{proposition}
\begin{proof}
	Sia l'additività che la monotonia seguono facilmente dalla \cref{def:IntegraleIntegrabili} e dal \cref{DefinizioneEquivalenteIntegraleIntegrabili}, sfruttando la \cref{prop:IntegralePositive}.
\end{proof}



\begin{definition}
	Dato uno spazio di misura $(X,\A,\mu)$ definiamo
	\begin{equation*}
		\L^1(X,\A,\mu)=\{ f:X\to\Rbar \text{ integrabili} \}
	\end{equation*}
\end{definition}

\begin{proposition}
	$\L^1(X,\A,\mu)$ è uno spazio vettoriale e $\LNorm{\cdot}$ è una seminorma su $\L^1(X,\A,\mu)$.
\end{proposition}
\begin{proof}
	Dalla \cref{prop:IntegraleIntegrabili} segue facilmente che $\L^1(X,\A,\mu)$ è uno spazio vettoriale.
	
	Dimostriamo ora che $\LNorm{\cdot}$ è una seminorma su $\L^1(X,\A,\mu)$. Innanzitutto abbiamo che per la \cref{prop:IntegraleIntegrabili} vale che
	\begin{equation*}
		\LNorm{\lambda f} = \int |\lambda f |\de\mu=|\lambda| \int |f| \de\mu=|\lambda|\LNorm f
	\end{equation*}
	Inoltre vale anche la disuguaglianza triangolare, infatti sfruttando sempre la \cref{prop:IntegraleIntegrabili} otteniamo che
	\begin{equation*}
		\LNorm{f+g}=\int |f+g|\de\mu\le \int (|f|+|g|)\de\mu=\int |f|\de\mu+\int |g|\de\mu=\LNorm f+\LNorm g
	\end{equation*}
\end{proof}

\begin{theorem}[Convergenza dominata di Lebesgue]
	Sia $(f_n)$ una successione di funzioni integrabili su $(X,\A,\mu)$ convergenti puntalmente a $f$ e sia $g$ integrabile tale che $|f_n(x)|\le g(x)$ per ogni $x\in X$ e per ogni $n\in\N$. Allora
	\begin{equation*}
		\int f \de\mu=\lim_{n\to\infty}\int f_n\de\mu
	\end{equation*}
\end{theorem}

\begin{proof}
	Considero le due successioni di funzioni misurabili positive $(g\pm f_n)$ (rispettivamente con il segno $+$ e il segno $-$). Tali funzioni sono banalmente positive in quanto $|f_n(x)|\le g(x)$, inoltre convergono puntualmente alle funzioni $g\pm f$. Per il \cref{lem:Fatou} vale che
	\begin{equation*}
		\int g\de\mu\pm\int f\de\mu=\int (g\pm f) \de\mu \le \liminf_{n\to\infty} \int (g\pm f_n) \de\mu=\int g\de\mu +\liminf_{n\to\infty}\left( \pm\int f_n \de \mu\right)
	\end{equation*}
	Perciò scegliendo rispettivamente il $+$ e il $-$ otteniamo perciò
	\begin{equation*}
		\begin{cases}
			\int f \de\mu\le \liminf_{n\to\infty}\int f_n \de \mu \\
			\int f\de\mu \ge \limsup_{n\to\infty}\int f_n \de \mu
		\end{cases}
		\Longrightarrow \int f\de\mu = \lim_{n\to\infty}\int f_n \de \mu
	\end{equation*}

\end{proof}

\begin{theorem}[Disuguaglianza di Chebyshev]\label{thm:DisuguaglianzaChebyshev}
	Data una funzione $f:X\to\R$ integrabile, dove $(X,\A,\mu)$ è uno spazio di misura, e $\lambda>0$ vale
	\begin{equation*}
		\mu\left(\left\{x:\ |f(x)|>\lambda\right\}\right) \le \frac{\LNorm f}{\lambda}
	\end{equation*}
\end{theorem}
\begin{proof}
	Sia $A_\lambda$ l'insieme degli $x$ tali che $|f(x)|>\lambda$. Ovviamente $A_\lambda$ è un insieme misurabile per la definizione di funzione integrabile.
	
	Grazie alla \cref{prop:IntegraleIntegrabili} e per la definizione di integrale di una funzione semplice abbiamo
	\begin{equation*}
		|f|\ge\lambda \cdot \chi_{A_\lambda} \implies \int_X |f|\de\mu \ge \int_X \lambda\cdot\chi_{A_\lambda}\de\mu=\lambda\mu(A_\lambda)\implies
		\LNorm{f}\ge \lambda\mu(A_\lambda)
	\end{equation*}
	che è equivalente alla tesi.
\end{proof}

\begin{corollary}\label{cor:L1NullaAlloraNulla}
	Data $f:X\to\R$ integrabile, dove $(X,\A,\mu)$ è uno spazio di misura, tale che $\LNorm{f}=0$, risulta
	\begin{equation*}
		\mu\left(\left\{x:\ f(x)\not=0\right\}\right)=0
	\end{equation*}
\end{corollary}
\begin{proof}
	Per ogni $n\in\N$, chiamiamo $A_n$ l'insieme degli $x\in X$ tali che $|f(x)|>\frac 1n$.
	
	Dal \cref{thm:DisuguaglianzaChebyshev}, sfruttando $\LNorm{f}=0$ è facile ottenere $\mu(A_n)=0$. 
	Sfruttando quanto appena ottenuto insieme alla \sigsubadd[ità] della misura otteniamo facilmente la tesi:
	\begin{equation*}
		\mu\left(\left\{x:\ f(x)\not=0\right\}\right)=\mu\left(\bigcup_{n\in\N}\left\{x:\ |f(x)|>\frac1n\right\}\right)\le\sum_{n\in\N}\mu(A_n)=0
	\end{equation*}
\end{proof}









