\section{Misura su varietà differenziabili}
Obiettivo di questa sezione è formalizzare i concetti di ``lunghezza'', ``superficie'', ``volume'', utilizzando gli strumenti di teoria della misura affrontati finora. 

Vogliamo introdurre innanzitutto il concetto di varietà differenziabile $k$-dimensionale di $\R^n$, che sarà la struttura che generalizza la nostra idea di ``superficie'' e su cui definiremo una misura. In particolare una varietà differenziabile sarà parametrizzata da funzioni, chiamate immersioni iniettive, che gli conferiscono le proprietà di regolarità necessarie a definire la misura.
Per fare tutto ciò sfrutteremo la topologia naturalmente indotta da $\R^n$ sui suoi sottoinsiemi.

\begin{definition}
	Una funzione $f:\Omega \subseteq \R^k\to\R^n$, con $\Omega$ aperto, si dice immersione iniettiva se è differenziabile con continuità ed è iniettiva con differenziale iniettivo in ogni punto. In tal caso si dice che $f$ è una parametrizzazione $C^1$ della superficie $k$-dimensionale $f(\Omega)$.
\end{definition}

\begin{remark}\label{nota:TopologiaIndotta}
	Dato un sottoinsieme $Y$ di uno spazio topologico $X$, esiste una naturale topologia indotta su $Y$. In particolare un sottoinsieme $U$ di $Y$ è un aperto di $Y$ nella topologia indotta se e solo esiste un aperto $V$ di $X$ tale che $U=V\cap Y$. 
	
	Si verifica facilmente che questa topologia indotta è effettivamente una topologia su $Y$.
\end{remark}

D'ora in poi, quando lavoreremo su un sottoinsieme di $\R^n$, sottoinderemo di star considerando la topologia indotta su quel sottoinsieme, come definita nella \cref{nota:TopologiaIndotta}.

\begin{definition}\label{def:BorelianiSottoinsieme}
	Ricalcando la \cref{def:Boreliani}, definiamo Boreliani di un sottoinsieme $X$ di $\R^n$ come la \sigalg\ generata dagli aperti di $X$ nella topologia indotta e li indichiamo con $\Borel(X)$.
\end{definition}

\begin{definition}
	Un sottoinsieme $\Sigma$ di $\R^n$ è una varietà differenziabile $k$-dimensionale di $\R^n$ se per ogni $x\in\Sigma$ esiste un intorno aperto di $x$ (nella topologia indotta) in $\Sigma$ che ammette una parametrizzazione $C^1$ definita su un aperto di $\R^k$.
\end{definition}

Di seguito enunceremo, fra gli altri risultati, dei fatti di topologia di base non del tutto banali, che però non ci soffermeremo a dimostrare in quanto non strettamente pertinenti alla trattazione. Tali fatti ci serviranno a dimostrare alcuni lemmi utili ad arrivare alla definizione di misura su una varietà differenziabile di $\R^n$.

\begin{definition}
	Uno spazio topologico si dice spazio di Lindelöf se ogni suo ricoprimento aperto ammette un sottoricoprimento numerabile. 
\end{definition}

\begin{definition}
	Uno spazio topologico si dice separabile se contiene un sottoinsieme numerabile denso.
\end{definition}

\begin{proposition}\label{prop:SottoinsiemeSeparabile}
	Ogni sottoinsieme di uno spazio metrico (con topologia indotta dalla metrica) separabile è separabile (nella sua topologia indotta).
\end{proposition}

\begin{proposition}\label{prop:SeparabileLindelofMetrico}
	Per uno spazio metrico sono equivalenti essere separabile ed essere uno spazio di Lindelöf.
\end{proposition}

\begin{lemma}\label{lemma:SottovarietaUnioneNumerabile}
	Data $\Sigma$ varietà differenziabile $k$-dimensionale di $\R^n$, esiste un ricoprimento numerabile  $\{\Sigma_i\}_{i\in\N}$ di $\Sigma$ tale che, per ogni $i\in\N$, $\Sigma_i$ è aperto nella topologia di $\Sigma$ e ammette una parametrizzazione $C^1$ definita su un aperto $\Omega_i$ di $\R^k$.
\end{lemma}
\begin{proof}
	La varietà $\Sigma$ è separabile per la \cref{prop:SottoinsiemeSeparabile}, in quanto sottoinsieme di $\R^n$ che è uno spazio metrico separabile, e di conseguenza è anche uno spazio di Lindelöf con la sua topologia indotta per la \cref{prop:SeparabileLindelofMetrico}.
	
	Per la definizione stessa di varietà differenziabile $k$-dimensionale, per ogni punto $P\in\Sigma$ esiste un suo intorno aperto $\Sigma_P$ (nella topologia di $\Sigma$) che ammette parametrizzazione $C^1$. Abbiamo quindi che $\{\Sigma_P\}_{P\in\Sigma}$ è un ricoprimento aperto di $\Sigma$ e perciò, poichè $\Sigma$ è uno spazio di Lindelöf, possiamo estrarne un ricoprimento numerabile, da cui la tesi.
\end{proof}

\begin{proposition}\label{prop:ApertoUnioneCompatti}
	Ogni aperto $A$ di $\R^n$ si può scrivere come unione numerabile crescente di compatti.
\end{proposition}

\begin{lemma}\label{lemma:ImmagineApertiContinua}
	Sia $f:\R^k\to\R^n$ una funzione continua, allora $f$ manda aperti di $\R^k$ in Boreliani di $\R^n$.
\end{lemma}
\begin{proof}
	Dato $A$ aperto di $\R^k$, per la \cref{prop:ApertoUnioneCompatti} esiste una successione numerabile crescente di compatti $\{K_n\}_{n\in\N}$ tale che $A=\bigcup_{n\in\N}K_n$. Perciò abbiamo che
	\begin{equation*}
		f(A)=f\left(\bigcup_{n\in\N}K_n\right)=\bigcup_{n\in\N}f(K_n)\punto
	\end{equation*}
	L'immagine tramite una funzione continua di un compatto è compatta, quindi $f(K_n)$ è compatto per ogni $n\in\N$ e di conseguenza è anche un Boreliano di $\R^n$.
	
	Abbiamo ottenuto perciò che $f(A)$ si può scrivere come unione numerabile di Boreliani, quindi è anch'esso un Boreliano, come volevamo dimostrare.	
\end{proof}

\begin{lemma}\label{lemma:ContinuaImplicaBoreliana}
	Sia $f:X\subseteq\R^k\to Y\subseteq\R^n$ una funzione continua, allora $f$ è Boreliana, cioè controimmagine di Boreliani è Boreliana, dove si intendono come Boreliani quelli ottenuti dalla topologia indotta, come nella \cref{def:BorelianiSottoinsieme}. 
\end{lemma}
\begin{proof}
	La dimostrazione ricalca fondamentalmente quella della \cref{prop:CounterImgMis}, sfruttando che controimmagine di aperti tramite funzioni continue è aperta.
\end{proof}

\begin{remark}\label{nota:SigmaBoreliano}
	Utilizzando la stessa notazione del \cref{lemma:SottovarietaUnioneNumerabile}, notiamo che per il \cref{lemma:ImmagineApertiContinua} l'insieme $\Sigma_i$ è un Boreliano di $\R^n$, per ogni $i\in\N$, in quanto immagine di un aperto tramite la funzione continua $f_i$. Di conseguenza abbiamo anche che $\Sigma=\cup_{i\in\N}\Sigma_i$ è un Boreliano, poichè unione numerabile di Boreliani.  
\end{remark}

\begin{remark}\label{nota:BorelianiSottovarieta}
	Per la \cref{nota:SigmaBoreliano}, abbiamo che gli aperti di $\Sigma$ sono anche Boreliani di $\R^n$, poichè sono intersezione fra aperti di $\R^n$ e $\Sigma$, che è un Boreliano di $\R^n$. Perciò in particolare otteniamo che i Boreliani di $\Sigma$ sono un sottoinsieme dei Boreliani di $\R^n$.
\end{remark}

Abbiamo finalmente tutti gli strumenti per definire la misura di Lebesgue $k$-dimensionale su una varietà differenziabile $k$-dimensionale di $\R^n$. Prima di dare la definizione vera e propria cerchiamo però di capire quale è la forma che ci aspettiamo da questa misura su delle strutture più semplici di una varietà differenziabile. A prima vista infatti la definizione di misura $k$-dimensionale su una varietà differenziabile può sembrare del tutto controintuitiva, senza aver studiato precedentemente dei casi più semplici.

Consideriamo quindi il caso di un sottospazio vettoriale $k$-dimensionale $V$ di $\R^n$. Questo è un esempio speciale di varietà differenziabile $k$-dimensionale di $\R^n$, in quando esiste una funzione lineare $L:\R^k\to \R^n$, tale che $L(\R^k)=V$, $L$ è bigettiva con la sua immagine e ha facilmente differenziale iniettivo, in quanto il differenziale di una funzione lineare è la funzione stessa, quindi $L$ è una parametrizzazione $C^1$ di $V$.

Data $L:\R^k\to\R^n$ applicazione lineare, esiste sempre la decomposizione polare della matrice $L$ che è della forma $L=U\cdot S$, con $S=(L^T\cdot L)^{\frac 12}:\R^k\to\R^k$ matrice simmetrica invertibile (perchè $L$ ha rango $k$ essendo iniettiva) e $U=L\cdot (L^T\cdot L)^{-\frac 12}:\R^k\to\R^n$ ortogonale, cioè tale che $U^T\cdot U=I$.

Quello che ci aspettiamo da una misura su $V$ è che dipenda dalla metrica di $V$, cioè vorremmo che data $U:\R^k\to V$ isometria lineare (come quella che abbiamo ottenuto dalla decomposizione polare di $L$), valga che $\sigma(E)=m_k(U^{-1}(E))$ per ogni $E\in\Borel(V)$, dove abbiamo chiamato $\sigma$ la misura su $V$. Questo concetto si può comprendere meglio con un semplice esempio. Consideriamo infatti un sottospazio di dimensione 2 in $\R^3$ e prendiamo tre punti sul sottospazio alla stessa distanza uno dall'altro, che formano quindi un triangolo equilatero. Quello che vorremmo è che la misura di questo triangolo sia la stessa di un triangolo equilatero con lo stesso lato in $\R^2$, ma questo equivale esattamente a dire che vogliamo che la misura dipenda fondamentalmente dalla metrica del sottospazio.

Calcoliamo quindi a quanto equivale $m_k(U^{-1}(E))$, dato $E\in\Borel(V)$, in funzione della nostra ``immersione iniettiva'' $L$. Sfruttando la \cref{prop:MisuraImmagineLineare} e le proprietà del determinante, otteniamo
\begin{equation*}
	m_k(U^{-1}(E))=m_k(S\cdot L^{-1}(E))=|\det S |\cdot m_k(L^{-1}(E))=\sqrt{\det(L^T\cdot L)}\cdot m_k(L^{-1}(E))\virgola
\end{equation*}
in particolare ci possiamo quindi riscrivere $m_k(U^{-1}(E))$ come
\begin{equation*}
	m_k(U^{-1}(E))=\int_{L^{-1}(E)}\sqrt{\det(L^T\cdot L)}\de x\punto
\end{equation*}



\begin{definition}\label{def:MisuraKDimensionale}
	Sia $E\in\Borel(\Sigma$), dove $\Sigma$ è una varietà differenziabile $k$-dimensionale di $\R^n$, e siano $\{\Sigma_i\}_{i\in\N}$ e $\{\Omega_i\}_{i\in\N}$ come nel \cref{lemma:SottovarietaUnioneNumerabile}. Chiamiamo inoltre, per ogni $i\in\N$, $f_i:\Omega_i\to\Sigma_i$ l'immersione iniettiva che parametrizza $\Sigma_i$.
	
	Definiamo la misura di Lebesgue $k$-dimensionale di $E$ come
	\begin{equation*}
		\sigma(E)=\sum_{i\in\N} \sigma_i(E_i\cap \Sigma_i)\virgola
	\end{equation*}
	dove $E_i=E\setminus (\cup_{j<i}\Sigma_j)$ e $\sigma_i(F)=\int_{f_i^{-1}(F)}\sqrt{\det(Df_i(x)^TDf_i(x))} \de x$.
\end{definition}

\begin{lemma}\label{lemma:InvarianzaImmersione}
	Date $f:\Omega\subseteq\R^k\to M$ e $g:\Omega'\subseteq\R^k\to M$ parametrizzazioni $C^1$ della superficie $k$-dimensionale $M$, per ogni $E\in\Borel(M)$ sono definiti i seguenti integrali e vale che 
	\begin{equation*}
		\int_{g^{-1}(E)}\sqrt{\det(Dg(x)^TDg(x))}\de x=\int_{f^{-1}(E)}\sqrt{\det(Df(x)^TDf(x))}\de x\punto
	\end{equation*}
\end{lemma}
\begin{proof}
	Innanzitutto notiamo che, dato $E$ Boreliano di $M$, i due integrali sono definiti, in quanto $Df(x)$ e $Dg(x)$ sono continue e $f^{-1}(E)$ e $g^{-1}(E)$ sono Boreliani di $\R^k$. Infatti per la \cref{nota:BorelianiSottovarieta} $E$ è un Boreliano di $\R^n$, quindi $f^{-1}(E)$ e $g^{-1}(E)$ sono controimmagini di un Boreliano tramite funzioni continue e di conseguenza sono Boreliani di $\R^k$ per il \cref{lemma:ContinuaImplicaBoreliana}.

	Sia $\varphi=g\circ f^{-1}$, allora $\varphi$ è un diffeomorfismo $C^1$ fra gli aperti $\Omega$ e $\Omega'$. Quindi per il \cref{thm:CambioVariabile} otteniamo
	\begin{multline*}
		\int_{f^{-1}(E)}\sqrt{\det(Df(x)^TDf(x))}\de x=\int_{\varphi\circ g^{-1}(E)}\sqrt{\det(Df(x)^TDf(x))}\de x=\\
		=\int_{g^{-1}(E)}\sqrt{\det(Df(\varphi(x))^TDf(\varphi(x)))}\ |\det D\varphi(x)|\de x=\int_{g^{-1}(E)}\sqrt{\det(Dg(x)^TDg(x))}\de x\virgola
	\end{multline*}
	dove abbiamo usato che se $g=f\circ \varphi$, allora $Dg(x)=Df(\varphi(x))\cdot D\varphi(x)$.
\end{proof}

\begin{remark}
	La \cref{def:MisuraKDimensionale} è una buona definizione e non dipende dalla scelta del ricoprimento $\{\Sigma_i\}_{i\in\N}$ e delle immersioni iniettive $\{f_i\}_{i\in\N}$.
\end{remark}
\begin{proof}
	Innanzitutto notiamo che la definizione è ben posta, in quanto tutti gli integrali sono ben definiti. Infatti $Df_i(x)$ è continua per ogni $i\in\N$ e inoltre si dimostra facilmente per induzione su $i$ che $E_i\cap\Sigma_i$ è un Boreliano di $\R^n$, utilizzando la \cref{nota:BorelianiSottovarieta}. Quindi $f_i^{-1}(E_i\cap\Sigma_i)$ è un Boreliano di $\R^k$ per il \cref{lemma:ContinuaImplicaBoreliana} (analogamente a quanto detto nel \cref{lemma:InvarianzaImmersione}).

	Consideriamo ora due diversi ricoprimenti $\{\Sigma_i\}_{i\in\N}$ e $\{\Sigma_i'\}_{i\in\N}$ di $\Sigma$, che rispettano le ipotesi del \cref{lemma:SottovarietaUnioneNumerabile} e che ammettono rispettivamente parametrizzazioni $\{f_i\}_{i\in\N}$ e $\{g_i\}_{i\in\N}$. Vogliamo dimostrare che le misure $\sigma$ e $\sigma'$ indotte dai due ricoprimenti coincidono.
	
	Sia $B_{i,j}=(\Sigma_i\setminus (\cup_{k<i}\Sigma_k))\cap (\Sigma_j'\setminus (\cup_{k<j}\Sigma_j'))$, allora $\{B_{i,j}\}_{i,j\in\N}$ è una partizione di $\Sigma$ con elementi disgiunti (è facile verificare che $B_{i,j}\cap B_{i',j'}=\emptyset$ per ogni $i,j,i',j'\in\N$). In particolare, poichè
	\begin{equation*}
		E_i\cap\Sigma_i=(E\setminus (\cup_{j<i}\Sigma_j))\cap \Sigma_i=E\cap (\Sigma_i\setminus (\cup_{k<i}\Sigma_k))=E\cap (\cup_{j\in\N}B_{i,j})=\cup_{j\in\N}(E\cap B_{i,j})\virgola
	\end{equation*}
	abbiamo che
	\begin{equation*}
		\sigma_i(E_i\cap \Sigma_i)=\sigma_i(\cup_{j\in\N}(E\cap B_{i,j}))=\sum_{j\in\N}\sigma_i(E\cap B_{i,j})\virgola
	\end{equation*}
	dove l'ultima uguaglianza è vera perchè dati $A_j=E\cap B_{i,j}$, che sono disgiunti fra loro, risulta
	\begin{align*}
		\sigma_i(\cup_{j\in\N}A_j)& =\int_{f_i^{-1}(\cup_{j\in\N}A_j)}\sqrt{\det(Df_i(x)^TDf_i(x))} \de x\\
		&=\sum_{j\in\N}\int_{f_i^{-1}(A_j)}\sqrt{\det(Df_i(x)^TDf_i(x))} \de x=\sum_{j\in\N}\sigma_i(E\cap B_{i,j})\punto
	\end{align*}
	
	Otteniamo quindi che
	\begin{equation*}
		\sigma(E)=\sum_{i\in\N}\sigma_i(E_i\cap \Sigma_i)=\sum_{i,j\in\N} \sigma_i(E\cap B_{i,j})
	\end{equation*}
	e analogamente $\sigma'(E)=\sum_{i,j\in\N} \sigma_i'(E\cap B_{i,j})$.

	Per il \cref{lemma:InvarianzaImmersione} applicato alle parametrizzazioni $f_i$ e $g_j$ e al Boreliano $E\cap B_{i,j}$, abbiamo che $\sigma_i(E\cap B_{i,j})=\sigma_j'(E\cap B_{i,j})$, da cui otteniamo quindi che $\sigma(E)=\sigma'(E)$.
\end{proof}

\begin{theorem}
	La misura di Lebesgue $k$-dimensionale definita sui Boreliani di una varietà differenziabile $k$-dimensionale di $\R^n$ $\Sigma$ è effettivamente una misura, cioè $(\Sigma,\Borel(\Sigma),\sigma)$ è uno spazio di misura.
\end{theorem}
\begin{proof}
	I Boreliani di $\Sigma$ sono per definizione una \sigalg\ e $\sigma(\emptyset)=0$ banalmente, quindi per dimostrare che $(\Sigma,\Borel(\Sigma),\sigma)$ è uno spazio di misura ci rimane solo da verificare che $\sigma$ sia \sigadd.
\end{proof}



Cerchiamo ora di capire il perchè di questa definizione, studiando alcuni casi particolari. Innanzitutto ci riduciamo al caso in cui la varietà $C^1$ $k$-dimensionale che consideriamo è parametrizzata da un'unica funzione $f:\Omega\subseteq \R^k\to\Sigma$. Possiamo infatti limitarci a studiare questa situazione in quanto in generale la misura superficiale è semplicemente ``un'incollamento'' delle misure su superfici $k$-dimensionali parametrizzate. 

In particolare prendiamo ora in considerazione il caso ancora più semplice in cui la varietà è uno spazio affine $k$-dimensionale di $\R^n$, che chiameremo $V$.

\begin{remark}\label{nota:IsometriaSottospazio}
	Dato $V$ sottospazio affine $k$-dimensionale di $\R^n$, allora esiste $U:\R^k\to V$ isometria lineare.
\end{remark}

Quello che ci aspettiamo da una misura su $V$ è che si comporti come la misura di Lebesgue su $\R^k$, cioè che dipenda dalla metrica del sottospazio $V$. Perciò vorremmo che data $U:\R^k\to V$ isometria lineare (che esiste per la \cref{nota:IsometriaSottospazio}), valga che $\sigma(E)=m_k(U^{-1}(E))$ per ogni $E\in\mathcal{B}(V)$. Ma questo risulta immediato in quanto
\begin{equation*}
	\sigma(E)=\int_{U^{-1}(E)}\sqrt{\det(DU(x)^TDU(x))}\de x=\int_{U^{-1}(E)}\sqrt{\det(U^TU)}\de x=m_k(U^{-1}(E))\virgola
\end{equation*}
dove abbiamo utilizzato che $DU(x)=U$, in quanto $U$ è lineare, e che $U$ è ortogonale e quindi $U^TU=I$.

\begin{example}
	Consideriamo il piano $x+y+z=1$ di $\R^3$ e in particolare il triangolo di tale piano formato dalla base canonica di $\R^3$. Tale triangolo è un triangolo equilatero di lato $\sqrt{2}$, vorremmo quindi che la sua misura (cioè la sua ``area'') sia quella di un triangolo equilatero in $\R^2$ con lo stesso lato. Questo però è ovvio per quanto appena detto, poichè la misura del triangolo equivale alla misura di un suo isometrico, che quindi è un triangolo con lo stesso lato.
\end{example}