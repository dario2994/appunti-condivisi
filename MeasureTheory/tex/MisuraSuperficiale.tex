\section{Misura su varietà differenziabili \texorpdfstring{di $\R^n$}{}}
Obiettivo di questa sezione è formalizzare i concetti di ``lunghezza'', ``superficie'', ``volume'', utilizzando gli strumenti di teoria della misura affrontati finora. 

Vogliamo introdurre innanzitutto il concetto di varietà differenziabile $k$-dimensionale di $\R^n$, che sarà la struttura che generalizza la nostra idea di ``superficie'' e su cui definiremo una misura. In particolare una varietà differenziabile sarà parametrizzata da funzioni, chiamate immersioni iniettive, che gli conferiscono le proprietà di regolarità necessarie a definire la misura.
Per fare tutto ciò sfrutteremo la topologia naturalmente indotta da $\R^n$ sui suoi sottoinsiemi.

\begin{definition}
	Una funzione $f:\Omega \subseteq \R^k\to\R^n$, con $\Omega$ aperto, si dice immersione iniettiva se è differenziabile con continuità ed è iniettiva con differenziale iniettivo in ogni punto. In tal caso si dice che $f$ è una parametrizzazione $C^1$ della superficie $k$-dimensionale $f(\Omega)$.
\end{definition}

\begin{remark}\label{nota:TopologiaIndotta}
	Dato un sottoinsieme $Y$ di uno spazio topologico $X$, esiste una naturale topologia indotta su $Y$. In particolare un sottoinsieme $U$ di $Y$ è un aperto di $Y$ nella topologia indotta se e solo esiste un aperto $V$ di $X$ tale che $U=V\cap Y$. 
	
	Si verifica facilmente che questa topologia indotta è effettivamente una topologia su $Y$.
\end{remark}

D'ora in poi, quando lavoreremo su un sottoinsieme di $\R^n$, sottoinderemo di star considerando la topologia indotta su quel sottoinsieme, come definita nella \cref{nota:TopologiaIndotta}.

\begin{definition}\label{def:BorelianiSottoinsieme}
	Ricalcando la \cref{def:Boreliani}, definiamo Boreliani di un sottoinsieme $X$ di $\R^n$ come la \sigalg\ generata dagli aperti di $X$ nella topologia indotta e li indichiamo con $\Borel(X)$.
\end{definition}

\begin{definition}
	Un sottoinsieme $\Sigma$ di $\R^n$ è una varietà differenziabile $k$-dimensionale di $\R^n$ se per ogni $x\in\Sigma$ esiste un intorno aperto di $x$ (nella topologia indotta) in $\Sigma$ che ammette una parametrizzazione $C^1$ definita su un aperto di $\R^k$.
\end{definition}

Di seguito enunceremo, fra gli altri risultati, dei fatti di topologia di base non del tutto banali, che però non ci soffermeremo a dimostrare in quanto non strettamente pertinenti alla trattazione. Tali fatti ci serviranno a dimostrare alcuni lemmi utili ad arrivare alla definizione di misura su una varietà differenziabile di $\R^n$.

\begin{definition}
	Uno spazio topologico si dice spazio di Lindelöf se ogni suo ricoprimento aperto ammette un sottoricoprimento numerabile. 
\end{definition}

\begin{definition}
	Uno spazio topologico si dice separabile se contiene un sottoinsieme numerabile denso.
\end{definition}

\begin{proposition}\label{prop:SottoinsiemeSeparabile}
	Ogni sottoinsieme di uno spazio metrico separabile (con topologia indotta dalla metrica) è separabile (nella sua topologia indotta).
\end{proposition}

\begin{proposition}\label{prop:SeparabileLindelofMetrico}
	Per uno spazio metrico sono equivalenti essere separabile ed essere uno spazio di Lindelöf.
\end{proposition}

\begin{lemma}\label{lemma:SottovarietaUnioneNumerabile}
	Data $\Sigma$ varietà differenziabile $k$-dimensionale di $\R^n$, esiste un ricoprimento numerabile  $\{\Sigma_i\}_{i\in\N}$ di $\Sigma$ tale che, per ogni $i\in\N$, $\Sigma_i$ è aperto nella topologia di $\Sigma$ e ammette una parametrizzazione $C^1$ definita su un aperto $\Omega_i$ di $\R^k$.
\end{lemma}
\begin{proof}
	La varietà $\Sigma$ è separabile per la \cref{prop:SottoinsiemeSeparabile}, in quanto sottoinsieme di $\R^n$ che è uno spazio metrico separabile, e di conseguenza è anche uno spazio di Lindelöf con la sua topologia indotta per la \cref{prop:SeparabileLindelofMetrico}.
	
	Per la definizione stessa di varietà differenziabile $k$-dimensionale, per ogni punto $P\in\Sigma$ esiste un suo intorno aperto $\Sigma_P$ (nella topologia di $\Sigma$) che ammette parametrizzazione $C^1$. Abbiamo quindi che $\{\Sigma_P\}_{P\in\Sigma}$ è un ricoprimento aperto di $\Sigma$ e perciò, poichè $\Sigma$ è uno spazio di Lindelöf, possiamo estrarne un ricoprimento numerabile, da cui la tesi.
\end{proof}

\begin{proposition}\label{prop:ApertoUnioneCompatti}
	Ogni aperto $A$ di $\R^n$ si può scrivere come unione numerabile crescente di compatti.
\end{proposition}

\begin{lemma}\label{lemma:ImmagineApertiContinua}
	Sia $f:\R^k\to\R^n$ una funzione continua, allora $f$ manda aperti di $\R^k$ in Boreliani di $\R^n$.
\end{lemma}
\begin{proof}
	Dato $A$ aperto di $\R^k$, per la \cref{prop:ApertoUnioneCompatti} esiste una successione numerabile crescente di compatti $\{K_n\}_{n\in\N}$ tale che $A=\bigcup_{n\in\N}K_n$. Perciò abbiamo che
	\begin{equation*}
		f(A)=f\left(\bigcup_{n\in\N}K_n\right)=\bigcup_{n\in\N}f(K_n)\punto
	\end{equation*}
	L'immagine tramite una funzione continua di un compatto è compatta, quindi $f(K_n)$ è compatto per ogni $n\in\N$ e di conseguenza è anche un Boreliano di $\R^n$.
	
	Abbiamo ottenuto perciò che $f(A)$ si può scrivere come unione numerabile di Boreliani, quindi è anch'esso un Boreliano, come volevamo dimostrare.	
\end{proof}

\begin{lemma}\label{lemma:ContinuaImplicaBoreliana}
	Sia $f:X\subseteq\R^k\to Y\subseteq\R^n$ una funzione continua, allora $f$ è Boreliana, cioè controimmagine di Boreliani è Boreliana, dove si intendono come Boreliani quelli ottenuti dalla topologia indotta, come nella \cref{def:BorelianiSottoinsieme}. 
\end{lemma}
\begin{proof}
	La dimostrazione ricalca fondamentalmente quella della \cref{prop:CounterImgMis}, sfruttando che controimmagine di aperti tramite funzioni continue è aperta.
\end{proof}

\begin{remark}\label{nota:SigmaBoreliano}
	Utilizzando la stessa notazione del \cref{lemma:SottovarietaUnioneNumerabile}, notiamo che per il \cref{lemma:ImmagineApertiContinua} l'insieme $\Sigma_i$ è un Boreliano di $\R^n$, per ogni $i\in\N$, in quanto immagine di un aperto tramite la funzione continua $f_i$. Di conseguenza abbiamo anche che $\Sigma=\cup_{i\in\N}\Sigma_i$ è un Boreliano, poichè unione numerabile di Boreliani.  
\end{remark}

\begin{remark}\label{nota:BorelianiSottovarieta}
	Per la \cref{nota:SigmaBoreliano}, abbiamo che gli aperti di $\Sigma$ sono anche Boreliani di $\R^n$, poichè sono intersezione fra aperti di $\R^n$ e $\Sigma$, che è un Boreliano di $\R^n$. Perciò in particolare otteniamo che i Boreliani di $\Sigma$ sono un sottoinsieme dei Boreliani di $\R^n$.
\end{remark}

Abbiamo finalmente tutti gli strumenti per definire la misura di Lebesgue $k$-dimensionale su una varietà differenziabile $k$-dimensionale di $\R^n$. Prima di dare la definizione vera e propria cerchiamo però di capire quale è la forma che ci aspettiamo da questa misura su delle strutture più semplici di una varietà differenziabile. A prima vista infatti la definizione di misura $k$-dimensionale su una varietà differenziabile può sembrare del tutto controintuitiva, senza aver studiato precedentemente dei casi più semplici.

Consideriamo quindi il caso di un sottospazio vettoriale $k$-dimensionale $V$ di $\R^n$. Questo è un esempio speciale di varietà differenziabile $k$-dimensionale di $\R^n$, in quando esiste una funzione lineare $L:\R^k\to \R^n$, tale che $L(\R^k)=V$, $L$ è bigettiva con la sua immagine e ha facilmente differenziale iniettivo, in quanto il differenziale di una funzione lineare è la funzione stessa, quindi $L$ è una parametrizzazione $C^1$ di $V$.

Data $L:\R^k\to\R^n$ applicazione lineare, esiste sempre la decomposizione polare della matrice $L$ che è della forma $L=U\cdot S$, con $S=(L^T\cdot L)^{\frac 12}:\R^k\to\R^k$ matrice simmetrica invertibile \footnote{Data $A$ matrice simmetrica definita positiva (che nel nostro caso è $L^T\cdot L$), esiste sempre una matrice denotata con $A^\frac 12$ che elevata al quadrato dà $A$.} e $U=L\cdot (L^T\cdot L)^{-\frac 12}:\R^k\to\R^n$ ortogonale, cioè tale che $U^T\cdot U=I$.

Quello che vogliamo da una misura su $V$ è che coincida con quella che potremmo costruire imitando quello che abbiamo fatto su $\R^k$. Infatti data una base ortonormale di $V$ nessuno ci vieta di definire l'insieme dei parallelepipedi $k$-dimensionali di $V$, come nella \cref{def:LebesgueSemiaperti}, e i loro volumi, come nella \cref{def:LebesgueElementare}, e procedere quindi alla costruzione della misura su $V$ esattamente come abbiamo fatto nella \cref{sezione:MisuraLebesgue}.
Questo equivale a dire che data $U:\R^k\to V$ isometria lineare (come quella che abbiamo ottenuto dalla decomposizione polare di $L$), vorremo che valga $\sigma(E)=m_k(U^{-1}(E))$ per ogni $E\in\Borel(V)$, dove abbiamo chiamato $\sigma$ la misura su $V$. Infatti scegliere $U:\R^k\to V$ isometria lineare equivale a prendere una base ortonormale di $V$, mentre imporre $\sigma(E)=m_k(U^{-1}(E))$ vuol dire ``copiare'' la misura di $\R^k$ su $V$.

Calcoliamo quindi a quanto equivale $m_k(U^{-1}(E))$, dato $E\in\Borel(V)$, in funzione della nostra ``immersione iniettiva'' $L$. Sfruttando la \cref{prop:MisuraImmagineLineare} e le proprietà del determinante, otteniamo
\begin{equation*}
	m_k(U^{-1}(E))=m_k(S\cdot L^{-1}(E))=\lvert\det S\rvert\cdot m_k(L^{-1}(E))=\sqrt{\det(L^T\cdot L)}\cdot m_k(L^{-1}(E))\virgola
\end{equation*}
in particolare vorremmo quindi che la misura $k$-dimensionale di $E$ sia uguale a
\begin{equation*}
	\sigma(E)=m_k(U^{-1}(E))=\int_{L^{-1}(E)}\sqrt{\det(L^T\cdot L)}\de x\punto
\end{equation*}

Dopo questa breve digressione, la definizione che stiamo per dare sembrerà meno arbitraria.

\begin{definition}\label{def:MisuraKDimensionale}
	Sia $E\in\Borel(\Sigma$), dove $\Sigma$ è una varietà differenziabile $k$-dimensionale di $\R^n$, e siano $\{\Sigma_i\}_{i\in\N}$ e $\{\Omega_i\}_{i\in\N}$ come nel \cref{lemma:SottovarietaUnioneNumerabile}. Chiamiamo inoltre, per ogni $i\in\N$, $f_i:\Omega_i\to\Sigma_i$ l'immersione iniettiva che parametrizza $\Sigma_i$.
	
	Definiamo la misura di Lebesgue $k$-dimensionale di $E$ come
	\begin{equation*}
		\sigma(E)=\sum_{i\in\N} \sigma_i(E\cap F_i)\virgola
	\end{equation*}
	dove $F_i=\Sigma_i\setminus (\cup_{j<i}\Sigma_j)$ e $\sigma_i$ è una funzione definita sui Boreliani di $\Sigma$ a valori in $\Rpiu$ tale che, dato $B\in\Borel(\Sigma)$, vale
	\begin{equation*}
		\sigma_i(B)=\int_{f_i^{-1}(B)}\sqrt{\det(\Diff f_i(x)^T\Diff f_i(x))} \de x\punto
	\end{equation*}

\end{definition}

Vogliamo ora dimostrare che quella appena data è una buona definizione, cioè non dipende dalla scelta di $\{\Sigma_i\}_{i\in\N}$ e dalle parametrizzazioni, tutte le quantità sono ben definite e $\sigma$ è veramente una misura.

\begin{lemma}\label{lemma:InvarianzaImmersione}
	Date $f:\Omega\subseteq\R^k\to M$ e $g:\Omega'\subseteq\R^k\to M$ parametrizzazioni $C^1$ della superficie $k$-dimensionale $M$, per ogni $E\in\Borel(M)$ sono definiti i seguenti integrali e vale che 
	\begin{equation*}
		\int_{g^{-1}(E)}\sqrt{\det(\Diff g(x)^T\Diff g(x))}\de x=\int_{f^{-1}(E)}\sqrt{\det(\Diff f(x)^T\Diff f(x))}\de x\punto
	\end{equation*}
\end{lemma}
\begin{proof}
	Innanzitutto notiamo che, dato $E\in\Borel(M)$, i due integrali sono definiti, in quanto $\Diff f(x)$ e $\Diff g(x)$ sono continue e $f^{-1}(E)$ e $g^{-1}(E)$ sono Boreliani di $\R^k$. Infatti per la \cref{nota:BorelianiSottovarieta} $E$ è un Boreliano di $\R^n$, quindi $f^{-1}(E)$ e $g^{-1}(E)$ sono controimmagini di un Boreliano tramite funzioni continue e di conseguenza sono Boreliani di $\R^k$ per il \cref{lemma:ContinuaImplicaBoreliana}.

	Sia $\varphi=f^{-1}\circ g$, allora $\varphi$ è un diffeomorfismo $C^1$ fra gli aperti $\Omega$ e $\Omega'$. Quindi per il \cref{thm:CambioVariabile} otteniamo
	\begin{multline*}
		\int_{f^{-1}(E)}\sqrt{\det(\Diff f(x)^T\Diff f(x))}\de x=\int_{\varphi\circ g^{-1}(E)}\sqrt{\det(\Diff f(x)^T\Diff f(x))}\de x=\\
		=\int_{g^{-1}(E)}\sqrt{\det(\Diff f(\varphi(x))^T\Diff f(\varphi(x)))}\ \lvert\det \Diff \varphi(x)\rvert\de x=\int_{g^{-1}(E)}\sqrt{\det(\Diff g(x)^T\Diff g(x))}\de x\virgola
	\end{multline*}
	dove abbiamo usato che se $g=f\circ \varphi$, allora $\Diff g(x)=\Diff f(\varphi(x))\cdot \Diff\varphi(x)$.
\end{proof}

\begin{remark}
	Notiamo che la funzione $\sigma_i:\Borel(\Sigma)\to\Rpiu$, introdotta nella \cref{def:MisuraKDimensionale}, è una misura sui Boreliani di $\Sigma$. DA SISTEMARE
\end{remark}
\begin{proof}
	Sia $f_i:\Omega_i\to\Sigma_i\subseteq\Sigma$ l'immersione iniettiva con cui definisco $\sigma_i$. La funzione $f_i$ è differenziabile con continuità
\end{proof}

\begin{proposition}\label{prop:DefMisuraKDimBuona}
	La \cref{def:MisuraKDimensionale} è una buona definizione e non dipende dalla scelta del ricoprimento $\{\Sigma_i\}_{i\in\N}$ e delle immersioni iniettive $\{f_i\}_{i\in\N}$.
\end{proposition}
\begin{proof}
	Innanzitutto notiamo che la definizione è ben posta, in quanto tutti gli integrali sono ben definiti. Infatti $\Diff f_i(x)$ è continua per ogni $i\in\N$ e inoltre è facile verificare che $E\cap F_i$ è un Boreliano di $\R^n$, utilizzando la \cref{nota:BorelianiSottovarieta}, in quanto intersezione di Boreliani. Quindi $f_i^{-1}(E\cap F_i)$ è un Boreliano di $\R^k$ per il \cref{lemma:ContinuaImplicaBoreliana} (analogamente a quanto detto nel \cref{lemma:InvarianzaImmersione}).

	Consideriamo ora due diversi ricoprimenti $\{\Sigma_i\}_{i\in\N}$ e $\{\Sigma_i'\}_{i\in\N}$ di $\Sigma$, tali che per ogni $i\in\N$ $\Sigma_i$ e $\Sigma_i'$ sono aperti nella topologia di $\Sigma$ e ammettono rispettivamente parametrizzazioni $f_i$ e $g_i$. Vogliamo dimostrare che le misure $\sigma$ e $\sigma'$ indotte dai due ricoprimenti coincidono.
	
	Chiamiamo $F_i=\Sigma_i\setminus (\cup_{j<i}\Sigma_j)$ ed $F_i'=\Sigma_i'\setminus (\cup_{j<i}\Sigma_j')$, come nella \cref{def:MisuraKDimensionale}. Sia poi $B_{ij}=F_i \cap F_j'$, allora $\{B_{ij}\}_{i,j\in\N}$ è una partizione di $\Sigma$ con elementi disgiunti (è facile verificare che $B_{ij}\cap B_{i'j'}=\emptyset$ per ogni scelta degli indici in $\N$). In particolare, poichè
	\begin{equation*}
		E\cap F_i=E\cap (\sqcup_{j\in\N}B_{ij})=\sqcup_{j\in\N}(E\cap B_{ij})\virgola
	\end{equation*}
	abbiamo che
	\begin{equation*}
		\sigma_i(E\cap F_i)=\sigma_i(\sqcup_{j\in\N}(E\cap B_{ij}))=\sum_{j\in\N}\sigma_i(E\cap B_{ij})\virgola
	\end{equation*}
	dove l'ultima uguaglianza è vera perchè dati $A_j=E\cap B_{ij}$, che sono disgiunti fra loro, risulta
	\begin{align*}
		\sigma_i(\cup_{j\in\N}A_j)& =\int_{f_i^{-1}(\cup_{j\in\N}A_j)}\sqrt{\det(\Diff f_i(x)^T\Diff f_i(x))} \de x\\
		&=\sum_{j\in\N}\int_{f_i^{-1}(A_j)}\sqrt{\det(\Diff f_i(x)^T\Diff f_i(x))} \de x=\sum_{j\in\N}\sigma_i(E\cap B_{ij})\punto
	\end{align*}
	
	Otteniamo quindi che
	\begin{equation*}
		\sigma(E)=\sum_{i\in\N}\sigma_i(E \cap F_i)=\sum_{i,j\in\N} \sigma_i(E\cap B_{ij})
	\end{equation*}
	e analogamente $\sigma'(E)=\sum_{i,j\in\N} \sigma_i'(E\cap B_{ij})$. Da notare che in queste sommatorie a due indici non ci dobbiamo preoccupare dell'ordine in cui si fanno le somme, perchè tutti i termini della sommatoria sono positivi (poichè integrali di funzioni positive).

	Per il \cref{lemma:InvarianzaImmersione} applicato alle parametrizzazioni $f_i$ e $g_j$ e al Boreliano $E\cap B_{ij}$, abbiamo però che $\sigma_i(E\cap B_{ij})=\sigma_j'(E\cap B_{ij})$, da cui otteniamo proprio che 
	\begin{equation*}
		\sigma(E)=\sum_{i,j\in\N} \sigma_i(E\cap B_{ij})=\sum_{i,j\in\N} \sigma_i'(E\cap B_{ij})=\sigma'(E)\punto
	\end{equation*}

\end{proof}

\begin{theorem}
	La misura di Lebesgue $k$-dimensionale definita sui Boreliani di una varietà differenziabile $k$-dimensionale di $\R^n$ $\Sigma$ è effettivamente una misura, cioè $(\Sigma,\Borel(\Sigma),\sigma)$ è uno spazio di misura.
\end{theorem}
\begin{proof}
	I Boreliani di $\Sigma$ sono per definizione una \sigalg\ e $\sigma(\emptyset)=0$ banalmente, quindi per dimostrare che $(\Sigma,\Borel(\Sigma),\sigma)$ è uno spazio di misura ci rimane solo da verificare che $\sigma$ sia \sigadd.
	
	Per la \sigadd[ità] di $\sigma_i$, già mostrata nella dimostrazione della \cref{prop:DefMisuraKDimBuona}, abbiamo che
	\begin{multline*}
		\sigma(\cup_{k\in\N}E_k)=\sum_{i\in\N}\sigma_i((\cup_{k\in\N}E_k)\cap F_i)=\sum_{i\in\N}\sigma_i(\cup_{k\in\N}(E_k\cap F_i))\\
		=\sum_{i\in\N}\sum_{k\in\N}\sigma_i(E_k\cap F_i)=\sum_{k\in\N}\sum_{i\in\N}\sigma_i(E_k\cap F_i)=\sum_{k\in\N}\sigma(E_k)\virgola
	\end{multline*}
	che è proprio quello che volevamo dimostrare.
\end{proof}