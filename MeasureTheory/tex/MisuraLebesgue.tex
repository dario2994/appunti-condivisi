\section{Misura di Lebesgue}
Ora applicheremo i risultati astratti ottenuti nelle due precedenti sezioni al caso più tangibile della retta reale.

Definiremo la misura di Lebesgue e, oltre a chiarire come mai questa sia la misura più naturale su $\R$, studieremo i misurabili secondo Lebesgue mostrando sia che non coincidono con la \sigalg{} dei Boreliani (cioè la \sigalg{} generata dagli aperti) sia che non coincidono con le parti di $\R$.
In particolare, la distinzione tra Boreliani e misurabili verrà fatta nella sezione seguente, poichè la dimostrazione risulta naturale solo dopo aver introdotto la teoria delle funzioni misurabili.

\begin{definition}
	I Boreliani di $\R^n$ sono la \sigalg{} generata dai sottoinsiemi aperti di $\R^n$.
\end{definition}

\newcommand{\so}[2]{\ensuremath{[\,#1,\,#2\,)}}
\newcommand{\oo}[2]{\ensuremath{(\,#1,\,#2\,)}}
\newcommand{\cc}[2]{\ensuremath{[\,#1,\,#2\,]}}

\begin{definition}
	Indicheremo con $\S_n\subseteq\mathcal P(\R^n)$ l'insieme dei parallelepipedi $n$-dimensionali semiaperti a destra\footnote{Se $a\ge b$ con la scrittura $\so{a}{b}$ si intenderà l'insieme vuoto.}:
	\begin{equation*}
		\S_n=\left\{\so{a_1}{b_1}\times\cdots\times\so{a_n}{b_n}:\ (a_i)_{1\le i\le n},(b_i)_{1\le i\le n}\subseteq \R\right\}
	\end{equation*}
	
	Inoltre, dato $S=\so{a_1}{b_1}\times\cdots\times\so{a_n}{b_n}$, definiamo $S^-_i=a_i$ e $S^+_i=b_i$.
\end{definition}

\begin{lemma}\label{lem:SemianelloSemiAperti}
	La famiglia $\S_n$ è un \semiring{}.
\end{lemma}
\begin{proof}
	Ovviamente $\emptyset\in\S_n$.
	Inoltre dati $A,B\in\S_n$ si ricava facilmente che
	\begin{equation*}
		A\cap B=\so{\max(A^-_1,B^-_1)}{\min(A^+_1,B^+_1)}\times\cdots\times\so{\max(A^-_n,B^-_n)}{\min(A^+_n,B^+_n)}\in\S_n
	\end{equation*}

	Mentre per la differenza $A\setminus B$ bisogna decomporre in maniera più complessa. TODO
	\begin{equation*}
		\so ab\setminus \so cd= \so ac\sqcup \so db
	\end{equation*}

\end{proof}

\begin{definition}
	Indicherò con $m_n:\S_n\to\Rpiu$ la funzione che associa ad ogni parallelepipedo il suo volume $n$-dimensionale:
	\begin{equation*}
		m_n(S)=\prod_{i=1}^n\max(0,S^+_i-S^-_i)
	\end{equation*}
\end{definition}

\begin{lemma}\label{lem:LebesgueElementareFinita}
	Dati $(S_i)_{1\le i\le k},S\subseteq \S_n$, valgono le seguenti disuguaglianze:
	\begin{itemize}
		\item Se gli $S_i$ sono disgiunti e $\bigsqcup_{i=1}^k S_i\subseteq S$ allora risulta
		\begin{equation*}
			\sum_{i=1}^k m_n(S_i)\le m_n(S)
		\end{equation*}
		\item Se vale il contenimento $S\subseteq\bigcup_{i=1}^k S_i$ allora risulta
		\begin{equation*}
			\sum_{i=1}^k m_n(S_i)\ge m_n(S)
		\end{equation*}
	\end{itemize}
\end{lemma}
\begin{proof}
	TODO
\end{proof}

\begin{definition}\label{def:AllargamentoSemiaperti}
	Fissato $\lambda>0$ definiamo $F_\lambda:\S_n\to\S_n$ come l'operatore che associa ad $S\in\S_n$ l'insieme nullo se $S=\emptyset$ e altrimenti
	\begin{equation*}
		F_\lambda(S)=\so{S^-_1-\epsilon}{S^+_1}\times\cdots\times\so{S^-_n-\epsilon}{S^+_n}
	\end{equation*}
	dove $\epsilon>0$ è definito come
	\begin{equation*}
		\epsilon=\min\left(1,\frac{\lambda}{2^n\cdot m_n(S)}\right)\cdot\min_{1\le i\le n}\{S^+_i-S^-_o\}
	\end{equation*}
\end{definition}
\begin{remark}\label{nota:ParteInternaAllargamento}
	Segue banalmente dalla definizione che $S\in\S_n$ è un sottoinsieme della parte interna di $F_\lambda(S)$ per ogni $\lambda>0$.
\end{remark}

\begin{proposition}\label{prop:MisuraAllargamento}
	Fissati $\lambda>0$ e $S\in\S_n$ vale la seguente stima:
	\begin{equation*}
		m_n(S)\le m_n(F_\lambda(S))\le m_n(S)+\lambda
	\end{equation*}
\end{proposition}
\begin{proof}
	La prima disuguaglianza è ovvia.
	
	La seconda è ovvia se $S$ è vuoto, quindi assumiamo $S\not=\emptyset$.
	
	Ponendo $\epsilon$ come nella \cref{def:AllargamentoSemiaperti}, risulta vero
	\begin{multline*}
		\frac{m_n(F_\lambda(S))}{m_n(S)}=\prod_{i=1}^n\frac{S^+_i-S^-_i+\epsilon}{S^+_i-S^-_i}=
		\prod_{i=1}^n\left(1+\frac{\epsilon}{S^+_i-S^-_i}\right)\\\le
		\prod_{i=1}^n\left(1+\min\left(1,\frac{\lambda}{2^n\cdot m_n(S)}\right)\right)\le
		1+2^n\frac{\lambda}{2^n\cdot m_n(S)}=1+\frac{\lambda}{m_n(S)}
	\end{multline*}
	che implica la tesi moltiplicando ambo i membri per $m_n(S)$.
\end{proof}

\begin{theorem}\label{LebesguePremisura}
	La terna $(\R^n,\S_n,m_n)$ è uno spazio di misura elementare.
\end{theorem}
\begin{proof}
	Per quanto mostrato nel \cref{lem:SemianelloSemiAperti} la famiglia $\S_n$ è un \semiring{}.
	
	Resta da dimostrare solo che $m_n$ è \sigadd{} su $\S_n$.
	Perciò fisso $(S_i)_{i\in\N}\subseteq \S_n$ disgiunti tali che la loro unione disgiunta da $S\in\S_n$.
	
	Applicando il \cref{lem:LebesgueElementareFinita} abbiamo facilmente
	\begin{equation*}
		\forall k\in\N:\ \sqcup_{i=1}^k S_i\subseteq S\implies \forall k\in\N:\ \sum_{i=1}^k m_n(S_i)\le m_n(S) \implies \sum_{i\in\N}m_n(S_i)\le m_n(S)
	\end{equation*}

	
	Per ottenere la disuguaglianza opposta, concludendo quindi la dimostrazione, sfrutteremo la compattezza dei chiusi e limitati di $\R^n$, in particolare la possibilità di estrarre ricoprimenti finiti di aperti a partire da ricoprimenti numerabili.
	
	Fissiamo $\epsilon>0$ arbitrario.
	
	Grazie alla \cref{nota:ParteInternaAllargamento} abbiamo che le parti interne degli elementi della successione $\left(F_{\frac\epsilon{2^i}}(S_i)\right)_{i\in\N}$ sono un ricoprimento del compatto $S$.
	Perciò esiste un insieme finito di indici $I\subseteq \N$ tale che $\left(F_{\frac\epsilon{2^i}}(S_i)\right)_{i\in I}$ è un ricoprimento finito di $S$.
	
	Sfruttando ancora il \cref{lem:LebesgueElementareFinita} e applicando \cref{prop:MisuraAllargamento} otteniamo
	\begin{equation*}
		\sum_{i\in\N}m_N(S_i)\ge \sum_{i\in I}m_N(S_i)\ge \sum_{i\in I}\left(m_n\left(F_{\frac\epsilon{2^i}}(S_i)\right)-\frac\epsilon{2^i}\right)
		\ge -\epsilon+\sum_{i\in I}m_n\left(F_{\frac\epsilon{2^i}}(S_i)\right)\ge m_n(S)-\epsilon
	\end{equation*}
	e visto che questo vale per ogni $\epsilon>0$ ne ricaviamo:
	\begin{equation*}
		\sum_{i\in\N}m_N(S_i)\ge m_n(S)
	\end{equation*}
	che conclude la dimostrazione della \sigadd[ità] di $m_n$.
\end{proof}

% \begin{remark}
% 	Il \cref{LebesguePremisura} vale anche, con le opportune modifiche alle definizioni, in $\R^n$ piuttosto che in $\R$. La dimostrazione procede in modo del tutto analogo, solo che le ragioni combinatoriche che rendevano banale tutto non appena il numero di intervalli era finito divengono più sfuggenti e necessitano di dimostrazione. Tratteremo però la possibilità di porre una misura su $\R^n$ nelle sezioni successive.
% \end{remark}

\begin{proposition}\label{LebesguePremisuraSigFin}
	Lo spazio di misura elementare $(\R^n,\S_n,m_n)$ è \sigfin[o].
\end{proposition}
\begin{proof}
	Sfruttando che $\mathbb Z^n$ è numerabile, mostriamo esplicitamente la \sigfin[ezza]:
	\begin{equation*}
		\R^n=\bigsqcup_{i_1,i_2,\dots,i_n\in\mathbb Z^n} \so{i_1}{i_1+1}\times\cdots \times\so{i_n}{i_n+1}
	\end{equation*}
	
\end{proof}

\begin{proposition}\label{SigAlgUgualeBoreliani}
	La \sigalg{} generata da $\S_n$ coincide con i Boreliani di $\R^n$.
\end{proposition}
\begin{proof}
	Fissati $(a_i)_{1\le i\le n},(b_i)_{1\le i\le n}\subseteq\R^n$ tali che per ogni $1\le i\le n$ valga $a_i<b_i$, risulta l'identità insiemistica
	\begin{equation*}
		\oo{a_1}{b_1}\times\cdots\times\oo{a_n}{b_n}=\bigcup_{i\in\N}\so{a_1+\frac1i}{b_1}\times\cdots\times\so{a_n+\frac1i}{b_n}
	\end{equation*}
	da cui otteniamo che gli $n$-parallelepipedi aperti appartengono a $\sigma A(\S_n)$.
	Ma in $\R^n$ gli aperti sono sempre unione numerabile di $n$-parallelepipedi aperti\footnote{Basta considerare l'unione di tutti gli $n$-cubi con centro razionale e lato razionale contenuti nell'aperto.} e di conseguenza gli aperti appartengono a $\sigma A(\S_n)$.
	
	Ma allora la \sigalg{} generata dagli aperti e quella generata da $\S_n$ e perciò si ha la tesi.
\end{proof}



\begin{definition}\label{LebesgueMisura}
	Dato lo spazio di misura elementare $(\R_n,\S_n,m_n)$, sia $\M_n$, che verrà chiamato l'insieme dei misurabili secondo Lebesgue, la relativa \sigalg{} di Caratheodory e $m_n:\M_n\to\Rpiu$ \footnote{Qui abusiamo leggermente di notazione, visto che con $m_n$ si indicava la premisura.}, che verrà chiamata misura di Lebesgue, la misura associata, la cui esistenza ci è assicurata dal \cref{EstensioneCaratheodory}.
\end{definition}

\begin{remark}\label{LebesgueCompletezza}
	La misura di Lebesgue su $\R^n$ è completa.
\end{remark}
\begin{proof}
	È un'ovvia conseguenza del \cref{EstensioneCaratheodory}.
\end{proof}

\begin{proposition}
	I Boreliani di $\R^n$ sono un sottoinsieme di $\M_n$.
\end{proposition}
\begin{proof}
	Il \cref{EstensioneCaratheodory} mi assicura che la \sigalg{} di Caratheodory definita nella \cref{LebesgueMisura} contiene la \sigalg{} generata da $\S_n$ e perciò, sfruttando \cref{SigAlgUgualeBoreliani}, otteniamo i Boreliani sono misurabili secondo Lebesgue come voluto.
\end{proof}

\begin{proposition}\label{CardBoreliani}
	I Boreliani hanno la cardinalità del continuo.
\end{proposition}
\begin{remark}
	I Boreliani si possono ottenere a partire dall'insieme degli aperti $\tau$ con una successione di insiemi, ottenendo uno dal precedente
	mediante aggiunta dei complementari e delle unioni numerabili. Tuttavia non basta una successione finita, né l'unione degli insiemi
	così ottenuti. Vediamo allora come formalizzare questa costruzione utilizzando un'indicizzazione sugli ordinali.
	
	Questa costruzione permetterà poi di ottenere facilmente la cardinalità dei Boreliani.
\end{remark}
\begin{proof}
	Consideriamo la seguente funzione, definita $f:ON \rightarrow \mathcal{P}(\mathcal{P}(\R))$:
	\[
	f(\alpha) = \left\{
		\begin{array}{ll}
			\tau & \quad se\ \alpha=0 \\
			\{ E\subseteq \R : \exists \{A_n\}_{n\in \N}\subseteq f(\beta), E = \bigcap_{n\in\N}A_n\}
			\cup\{E\subseteq\R : E^\mathsf{c}\in f(\beta)\} & \quad se\ \alpha=\beta+1\\
			\bigcup_{\beta < \alpha}f(\alpha) & \quad se\ \alpha\ \grave{e}\ un\ ordinale\ limite.
		\end{array}
	\right.
	\]

\end{proof}


\begin{proposition}
	La misura di Lebesgue è l'unica possibile estensione alla \sigalg{} dei Boreliani della premisura definita sugli intervalli semiaperti a destra nel \cref{LebesguePremisura}.
\end{proposition}
\begin{proof}
	È una banale conseguenza di \cref{UnicitaCaratheodory}, che si può applicare ricordando \cref{LebesguePremisuraSigFin} e notando che la \sigalg{} generata dagli intervalli semiaperti sono i Boreliani come mostrato in \cref{SigAlgUgualeBoreliani}.
\end{proof}

\begin{remark}\label{LebesgueInvarianteTraslazione}
	La misura di Lebesgue $m_1:\M\to\Rpiu$ è invariante per traslazione.
\end{remark}
\begin{proof}
	È sufficiente ricordare che la misura di Lebesgue è stata costruita appplicando il teorema di Caratheodory e perciò nasce come la riduzione della misura esterna associata a $\mu$ (come definita in \cref{LebesguePremisura}). Ma la misura esterna era ovviamente invariante per traslazione, visto che lo era $\mu$ stessa (la lunghezza di un intervallo non cambia se lo traslo), e quindi $m_1$ è invariante per traslazione.
\end{proof}

\begin{proposition}\label{NumerabiliLebesgueTrascurabili}
	Dato un insieme numerabile $A\subseteq\R$, questo è misurabile con misura nulla.
\end{proposition}
\begin{proof}
	I singoli punti, essendo banalmente trascurabili, sono Lebesgue misurabili visto che la misura di Lebesgue è completa, come mostrato in \cref{LebesgueCompletezza}.
	
	L'insieme $A$ è però numerabile, quindi unione numerabile di singoli punti, che sono trascurabili. Perciò è trascurabile a sua volta $A$ che significa che $A$ è misurabile di misura nulla.
\end{proof}
\begin{remark}
	È importante notare che la proposizione \cref{NumerabiliLebesgueTrascurabili} ci permette di trattare senza troppa attenzione intervalli aperti, semiaperti e chiusi tutti allo stesso modo rispetto alla misura, visto che a distinguerli sono solo i singoli punti, che non fanno alcuna differenza.
\end{remark}




\begin{theorem}[Insieme di Vitali]\label{InsiemeVitali}
	Dato un sottoinsieme $A\in\M$ misurabile secondo Lebesgue con misura non nulla, esiste un sottoinsieme $B\subseteq A$ non misurabile secondo Lebesgue, cioè $B\not\in\M$.
\end{theorem}
\begin{proof}
	Dato $A$, notiamo che per la \sigadd[ità] della misura vale:
	\begin{equation*}
		0<m_1(A)=\sum_{n\in\mathbb Z} m_1\left(A\cap\so n{n+1}\right)
	\end{equation*}
	e perciò in particolare, visto che la serie ha somma positiva, ne ricaviamo che esiste $n_0$ tale che:
	\begin{equation*}
		0<m_1\left(A\cap\so {n_0}{n_0+1}\right)\le m_1\left(\so {n_0}{n_0+1}\right)=1
	\end{equation*}
	quindi, a meno di intersecare con l'intervallo $\so {n_0}{n_0+1}$, possiamo assumere $A$ sia limitato e con diametro minore o uguale ad $1$. In particolare, senza perdita di generalità assumeremo $A\subseteq \so 01$.
	
	Pongo su $\R$ la relazione di equivalenza seguente:
	\begin{equation*}
		\forall x,y\in\R:\ x\equiv y\iff x-y\in\mathbb Q
	\end{equation*}
	Ora quozientiamo $\R$ rispetto a questa relazione d'equivalenza. In particolare siano $(R_i)_{i\in I}$ le classi d'equivalenza, dove $I$ è un insieme di indici. Sia infine $J$ il sottoinsieme degli indici definito come $J=\{i\in I:\ R_i\cap A\not =\emptyset\}$. 

	Applichiamo ora l'assioma della scelta alla famiglia di insiemi $(R_j\cap A)_{j\in J}$ e estraiamone un insieme di rappresentanti privilegiati $(r_j)_{j\in J}$. Sia ora $B$ l'insieme dei rappresentanti privilegiati.
	
	Vale, per costruzione, $B\subseteq A$. 
	Inoltre, ancora per la definizione di $B$ risulta\footnote{Definiamo lo shift come $A+k=\{a+k:\ a\in A\}$.}:
	\begin{equation}\label{ContenimentiVitali}
		A\subseteq\bigsqcup_{q\in\mathbb Q\cap\cc{-1}{1}} B+q\subseteq \cc{-1}{2}
	\end{equation}
	dato che ogni elemento di $A$ si scrive \emph{in modo unico} (e questo spiega perchè l'unione è disgiunta) come un rappresentante privilegiato rispetto all'equivalenza più un razionale, che in questo caso possiamo scegliere tra $-1$ e $1$ poichè $A\subseteq \so 01$.
	
	Se assumiamo che $B$ sia misurabile, ora otteniamo un assurdo applicando \cref{ContenimentiVitali} e ricordando che $m_1$ è invariante per traslazione come mostrato in \cref{LebesgueInvarianteTraslazione}:
	\begin{equation*}
		0<m_1(A)\le \sum_{q\in \mathbb Q\cap\cc{-1}{1}} m_1(B+q)= \sum_{q\in \mathbb Q\cap\cc{-1}{1}} m_1(B) \le 3
	\end{equation*}
	che non può essere visto che stiamo sommando una quantità numerabile di volte il valore $m_1(B)$ e perciò possiamo ottenere solo $+\infty$ oppure $0$.
	
	Allora l'insieme $B$ deve essere non misurabile come richiesto.
\end{proof}

\begin{exercise}
	Dato un sottoinsieme $A\subseteq\R$ della retta reale di misura nulla secondo Lebesgue e un insieme di reali $T$ numerabile, esiste $k\in \R$ tale che $A+k$ sia disgiunto da $T$.
\end{exercise}
\begin{proof}
	Consideriamo l'insieme $B=\bigcup_{t\in T} (A-t)$. 
	Essendo unione numerabile di trascurabili è a sua volta trascurabile.
	Perciò esiste $k\in\R\setminus B$ visto che $\R$ non è trascurabile.
	
	Assumendo per assurdo che $A-k$ intersechi $T$, avremmo che esistono $t\in T$ e $a\in A$ tali che:
	\begin{equation*}
		a-k=t\implies k=a-t \implies k\in A-t\implies k\in B	
	\end{equation*}
	ma questo non può essere per definizione di $k$ e perciò otteniamo che $A-k$ è disgiunto da $T$, che è la tesi.
\end{proof}

\begin{theorem}[Steinhaus]\label{Steinhaus}
	Dato un insieme $A\subset\R$ misurabile non trascurabile, l'insieme $A-A=\{a_1-a_2:\ a_1,a_2\in A\}$ contiene un intorno di $0$.
\end{theorem}
\begin{proof}
	TODO.
	Probabilmente da fare usando il solito risultato indimostrabile sulla chiusura monotona 3 o 4 volte.
\end{proof}


