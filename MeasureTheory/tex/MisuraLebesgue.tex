\section{Misura di Lebesgue}
Ora applicheremo i risultati astratti ottenuti nelle due precedenti sezioni al caso più tangibile della retta reale.

Definiremo la misura di Lebesgue e, oltre a chiarire come mai questa sia la misura più naturale su $\R$, studieremo i misurabili secondo Lebesgue mostrando sia che non coincidono con la \sigalg{} dei boreliani (cioè la \sigalg{} generata dagli aperti) sia che non coincidono con le parti di $\R$.

\begin{definition}
	I Boreliani sono la \sigalg{} generata dai sottoinsiemi aperti della retta reale.
\end{definition}

\newcommand{\so}[2]{\ensuremath{[\,#1,\,#2\,)}}
\newcommand{\oo}[2]{\ensuremath{(\,#1,\,#2\,)}}
\newcommand{\cc}[2]{\ensuremath{[\,#1,\,#2\,]}}

\begin{theorem}\label{LebesguePremisura}
	Sia $\S$ l'insieme degli intervalli semiaperti a destra di $\R$, cioè i sottoinsiemi della retta reale della forma $[a,b)$ con $a,b\in\R$ \footnote{Se $a\ge b$ con la scrittura $[a,b)$ si intenderà l'insieme vuoto.}.
	
	Definendo la funzione $\mu:\S\to\Rbar$ in modo che $\mu\left([a,b)\right)=b-a$, la terna $(\R,\S,\mu)$ risulta essere uno spazio di misura elementare.
\end{theorem}
\begin{proof}
	L'insieme vuoto appartiene ovviamente a $\S$.
	Inoltre, fissati $a,b,c,d\in\R$ valgono:
	\begin{align*}
		\so ab\cap \so cd &= \so {\max(a,c)}{\min(b,d)}\\
		\so ab\setminus \so cd&= \so ac\sqcup \so db
	\end{align*}
	e questo implica che $\S$ è un \semiring{}.
	
	Ora resta da dimostrare che $\mu$ sia \sigadd{} su $\S$.
	Consideriamo $\so {a_n}{b_n}=I_n\in \S$ una successione numerabile di elementi di $\S$ la cui unione \emph{disgiunta} dia $\so ab=I\in \S$.
	
	Riconducendoci ad un numero finito di intervalli, e sfruttando facili ragionamenti combinatorici, otteniamo:
	\begin{equation*}
		\sum_{n\le k} \mu(I_n)\le \mu(I) \implies \sum_{n\in\N}\mu(I_n)\le \mu(I)
	\end{equation*}
	
	Per ottenere la disuguaglianza opposta sfrutteremo la compattezza degli intervalli limitati di $\mathbb R$, in particolare la possibilità di estrarre ricoprimenti finiti di aperti a partire da ricoprimenti numerabili.
	
	Fissiamo $\epsilon>0$ arbitrario.
	
	Definiamo gli intervalli aperti $I'_n=\oo{a_n-\frac\epsilon{2^n}}{b_n}$ e notiamo che $I_n\subseteq I'_n$.
	Vale perciò che la successione di aperti $(I'_n)_{n\in\N}$ è un ricoprimento del compatto $\cc a{b-\epsilon}$ e di conseguenza esiste un insieme di indici finito $J$ tale che $(I'_n)_{n\in J}$ è un ricoprimento finito di $\cc a{b-\epsilon}$.
	
	Allora, ancora per facili motivazioni combinatoriche, abbiamo:
	\begin{equation*}
		\sum_{n\in J} b_n-\left(a_n-\frac\epsilon{2^n}\right)\ge b-\epsilon-a\implies
		\sum_{n\in\N} b_n-\left(a_n-\frac\epsilon{2^n}\right)\ge b-a-\epsilon \implies
		\sum_{n\in\N} \mu(I_n)\ge \mu(I)-2\epsilon
	\end{equation*}
	e visto che questo vale per ogni $\epsilon>0$ ne ricaviamo:
	\begin{equation*}
		\sum_{n\in\N}\mu(I_n)\ge \mu(I)
	\end{equation*}
	che insieme alla disuguaglianza opposta già dimostrata dimostra la \sigadd[ità] della funzione $\mu$.
	
	Quindi visto che $\S$ è un \semiring{} e $\mu$ una premisura su $\S$ concludo che $(\R,\S,\mu)$ è uno spazio di misura elementare.
\end{proof}

\begin{remark}
	Il \cref{LebesguePremisura} vale anche, con le opportune modifiche alla definizioni, in $\R^n$ piuttosto che in $\R$. La dimostrazione procede in modo del tutto analogo, solo che le ragioni combinatoriche che rendevano banale tutto non appena il numero di intervalli era finito divengono più sfuggenti e necessitano di dimostrazione. Tratteremo però la possibilità di porre una misura su $\R^n$ nelle sezioni successive.
\end{remark}

\begin{proposition}\label{LebesguePremisuraSigFin}
	Lo spazio di premisura $(\R,\S,\mu)$ come definito nel \cref{LebesguePremisura} è \sigfin[o].
\end{proposition}
\begin{proof}
	Mostriamo esplicitamente la \sigfin[ezza]:
	\begin{equation*}
		\R=\bigsqcup_{n\in\mathbb Z} \so{n}{n+1}
	\end{equation*}
\end{proof}

\begin{proposition}\label{SigAlgUgualeBoreliani}
	La \sigalg{} generata da $\S$, come definito nell'enunciato di \cref{LebesguePremisura}, coincide con i Boreliani.
\end{proposition}
\begin{proof}
	Fissati $a<b$ in $\R$ vale:
	\begin{equation*}
		\oo{a}{b}=\bigcup_{n\in\N}\so{a+\frac1{2^n}}b
	\end{equation*}
	e perciò otteniamo che gli intervalli aperti appartengono a $\sigma A(\S)$.
	Ma in $\R$ gli aperti sono sempre unione numerabile di intervalli aperti e di conseguenza gli aperti appartengono a $\sigma A(\S)$.
\end{proof}



\begin{definition}\label{LebesgueMisura}
	Dato lo spazio di misura elementare $(\R,\S,\mu)$ definito nel \cref{LebesguePremisura}, sia $\M$, che verrà chiamato l'insieme dei misurabili secondo Lebesgue, la relativa \sigalg{} di Caratheodory e $m_1:\M\to\Rpiu$ \footnote{L'$1$ al pedice di $m_1$, che verrà a volte omesso, sottolinea il fatto che la misura è quella riferita ad $\R^1$ e non $\R^n$.}, che verrà chiamata misura di Lebesgue, la misura associata, la cui esistenza ci è assicurata dal \cref{EstensioneCaratheodory}.
\end{definition}

\begin{remark}\label{LebesgueCompletezza}
	La misura di Lebesgue è completa.
\end{remark}
\begin{proof}
	È un'ovvia conseguenza del \cref{EstensioneCaratheodory}.
\end{proof}

\begin{proposition}
	I Boreliani sono un sottoinsieme dei misurabili secondo Lebesgue.
\end{proposition}
\begin{proof}
	Il \cref{EstensioneCaratheodory} mi assicura che la \sigalg{} di Caratheodory definita nella \cref{LebesgueMisura} contiene la \sigalg{} generata da $\S$ e perciò, sfruttando \cref{SigAlgUgualeBoreliani}, otteniamo i Boreliani sono misurabili secondo Lebesgue.
\end{proof}

\begin{proposition}
	La misura di Lebesgue è l'unica possibile estensione alla \sigalg{} dei Boreliani della premisura definita sugli intervalli semiaperti a destra nel \cref{LebesguePremisura}.
\end{proposition}
\begin{proof}
	È una banale conseguenza di \cref{UnicitaCaratheodory}, che si può applicare ricordando \cref{LebesguePremisuraSigFin} e notando che la \sigalg{} generata dagli intervalli semiaperti sono i Boreliani come mostrato in \cref{SigAlgUgualeBoreliani}.
\end{proof}

\begin{remark}\label{LebesgueInvarianteTraslazione}
	La misura di Lebesgue $m_1:\M\to\Rpiu$ è invariante per traslazione.
\end{remark}
\begin{proof}
	È sufficiente ricordare che la misura di Lebesgue è stata costruita appplicando il teorema di Caratheodory e perciò nasce come la riduzione della misura esterna associata a $\mu$ (come definita in \cref{LebesguePremisura}). Ma la misura esterna era ovviamente invariante per traslazione, visto che lo era $\mu$ stessa (la lunghezza di un intervallo non cambia se lo traslo), e quindi $m_1$ è invariante per traslazione.
\end{proof}

\begin{proposition}\label{NumerabiliLebesgueTrascurabili}
	Dato un insieme numerabile $A\subseteq\R$, questo è misurabile con misura nulla.
\end{proposition}
\begin{proof}
	I singoli punti, essendo banalmente trascurabili, sono Lebesgue misurabili visto che la misura di Lebesgue è completa, come mostrato in \cref{LebesgueCompletezza}.
	
	L'insieme $A$ è però numerabile, quindi unione numerabile di singoli punti, che sono trascurabili. Perciò è trascurabile a sua volta $A$ e sfruttando ancora la completezza di $m_1$ otteniamo che $A$ è misurabile di misura nulla.
\end{proof}
\begin{remark}
	È importante notare che la proposizione \cref{NumerabiliLebesgueTrascurabili} ci permette di trattare senza troppa attenzione intervalli aperti, semiaperti e chiusi tutti allo stesso modo rispetto alla misura, visto che a distinguerli sono solo i singoli punti, che non fanno alcuna differenza.
\end{remark}




\begin{theorem}[Insieme di Vitali]
	Dato un sottoinsieme $A\in\M$ misurabile secondo Lebesgue con misura non nulla, esiste un sottoinsieme $B\subseteq A$ non misurabile secondo Lebesgue, cioè $B\not\in\M$.
\end{theorem}
\begin{proof}
	Dato $A$, notiamo che per la \sigadd[ità] della misura vale:
	\begin{equation*}
		0<m_1(A)=\sum_{n\in\mathbb Z} m_1\left(A\cap\so n{n+1}\right)
	\end{equation*}
	e perciò in particolare, visto che la serie ha somma positiva, ne ricaviamo che esiste $n_0$ tale che:
	\begin{equation*}
		0<m_1\left(A\cap\so {n_0}{n_0+1}\right)\le m_1\left(\so {n_0}{n_0+1}\right)=1
	\end{equation*}
	quindi, a meno di intersecare con l'intervallo $\so {n_0}{n_0+1}$, possiamo assumere $A$ sia limitato e con diametro minore o uguale ad $1$. In particolare, senza perdita di generalità assumeremo $A\subseteq \so 01$.
	
	Pongo su $\R$ la relazione di equivalenza seguente:
	\begin{equation*}
		\forall x,y\in\R:\ x\equiv y\iff x-y\in\mathbb Q
	\end{equation*}
	Ora quozientiamo $\R$ rispetto a questa relazione d'equivalenza. In particolare siano $(R_i)_{i\in I}$ le classi d'equivalenza, dove $I$ è un insieme di indici. Sia infine $J$ il sottoinsieme degli indici definito come $J=\{i\in I:\ R_i\cap A\not =\emptyset\}$. 

	Applichiamo ora l'assioma della scelta alla famiglia di insiemi $(R_j\cap A)_{j\in J}$ e estraiamone un insieme di rappresentanti privilegiati $(r_j)_{j\in J}$. Sia ora $B$ l'insieme dei rappresentanti privilegiati.
	
	Vale, per costruzione, $B\subseteq A$. 
	Inoltre, ancora per la definizione di $B$ risulta:
	\begin{equation}\label{ContenimentiVitali}
		A\subseteq\bigsqcup_{q\in\mathbb Q\cap\cc{-1}{1}} B+q\subseteq \cc{-1}{2}
	\end{equation}
	dato che ogni elemento di $A$ si scrive \emph{in modo unico} (e questo spiega perchè l'unione è disgiunta) come un rappresentante privilegiato rispetto all'equivalenza più un razionale, che in questo caso possiamo scegliere tra $-1$ e $1$ poichè $A\subseteq \so 01$.
	
	Se assumiamo che $B$ sia misurabile, ora otteniamo un assurdo applicando \cref{ContenimentiVitali} e ricordando che $m_1$ è invariante per traslazione come mostrato in \cref{LebesgueInvarianteTraslazione}:
	\begin{equation*}
		0<m_1(A)\le \sum_{q\in \mathbb Q\cap\cc{-1}{1}} m_1(B+q)= \sum_{q\in \mathbb Q\cap\cc{-1}{1}} m_1(B) \le 3
	\end{equation*}
	che non può essere visto che stiamo sommando una quantità numerabile di volte il valore $m_1(B)$ e perciò possiamo ottenere solo $+\infty$ oppure $0$.
	
	Allora l'insieme $B$ deve essere non misurabile come richiesto.
\end{proof}

\begin{exercise}
	Dato un sottoinsieme $A\subseteq\R$ della retta reale di misura nulla secondo Lebesgue e un insieme di reali $T$ numerabile, esiste $k\in \R$ tale che $A+k$ \footnote{Definiamo lo shift come $A+k=\{a+k:\ a\in A\}$.} sia disgiunto da $T$.
\end{exercise}
\begin{proof}
	Consideriamo l'insieme $B=\bigcup_{t\in T} (A-t)$. 
	Essendo unione numerabile di trascurabili è a sua volta trascurabile.
	Perciò esiste $k\in\R\setminus B$ visto che $\R$ non è trascurabile.
	
	Assumendo per assurdo che $A-k$ intersechi $T$, avremmo che esistono $t\in T$ e $a\in A$ tali che:
	\begin{equation*}
		a-k=t\implies k=a-t \implies k\in A-t\implies k\in B	
	\end{equation*}
	ma questo non può essere per definizione di $k$ e perciò otteniamo che $A-k$ è disgiunto da $T$, che è la tesi.
\end{proof}




