\section{L'integrazione negli spazi Euclidei}
Approfondiamo ora la teoria dell'integrazione nell'ambientazione più classica: lo spazio $\R^n$ munito della misura di Lebesgue.

Mostreremo che l'integrale di Lebesgue non è che una generalizzazione dell'integrale di Riemann e che la misura prodotto definibile su $\R^n$ a partire dalla misura sulla retta reale coincide proprio con la misura $m_n$. Questi due risultati forniranno, a meno di applicare i teoremi di Fubini e Tonelli, i metodi primari per calcolare gli integrali in più dimensioni.

La seconda parte della sezione sarà completamente votata alla dimostrazione della formula del cambio di variabile, che necessita di un gran numero di lemmi e di un teorema, il teorema di Radon-Nikodym, che lasceremo indimostrato.

\begin{proposition}\label{prop:MisuraProdottoEuclidea}
	La \sigalg{} prodotto completata $\overline{\M_n\otimes\M_m}$ dei misurabili di $\R^n$ e $\R^m$ coincide con la \sigalg{} dei misurabili di $\R^{n+m}$.
\end{proposition}
\begin{proof}
	Lavoriamo sulla \sigalg{} prodotto \emph{non completata} $\M_n\otimes\M_m$, per poi ottenere l'enunciato ricordando che il completamento dei Boreliani sono i misurabili.

	Ricordando la \cref{def:LebesgueSemiaperti}, poichè valgono ovviamente i contenimenti $S_n\subseteq M_n$ e $S_m\subseteq M_m$, è facile ricavarne che $S_{n+m}\subseteq M_n\otimes M_m$.
	Ma allora, applicando la \cref{prop:SigAlgUgualeBoreliani} e ricordando che $\M_n\otimes M_m$ è una \sigalg{}, otteniamo che i Boreliani sono contenuti in $\M_n\otimes\M_m$.
	
	Sia $E_1\times E_2\in \M_n\times\M_m$. Per il \cref{thm:LebesgueEquivalenzeMisurabilita}, esistono $B_1,B_2$ Boreliani e $N_1,N_2$ trascurabili, rispettivamente in $R^n$ e $R^m$, tali che $E_1=A_1\sqcup N_1$ e $E_2=A_2\sqcup N_2$.
	Perciò, grazie alla distributività del prodotto insiemistico rispetto all'unione disgiunta, otteniamo
	\begin{equation*}
		E_1\times E_2=(A_1\sqcup N_1)\times(A_2\sqcup N_2)=\left(A_1\times A_2\right)\sqcup\left(A_1\times N_2\sqcup A_2\times N_1 \sqcup N_1\times N_2\right) \punto
	\end{equation*}
	Però l'insieme $A_1\times N_2\sqcup A_2\times N_1 \sqcup N_1\times N_2$ è trascurabile per la \cref{prop:TrascurabilePerInsiemeTrascurabile} e l'insieme $A_1\times A_2$ è un Boreliano in quanto prodotto di Boreliani\footnote{Lasciamo al lettore la dimostrazione che il prodotto di Boreliani è un Boreliano.}, allora applicando ancora il \cref{thm:LebesgueEquivalenzeMisurabilita} si ottiene $E_1\times E_2\in\M_{n+m}$.
	Vista la generalità della scelta di $E_1\times E_2$, quanto appena mostrato implica che $\M_n\times\M_m\subseteq \M_{n+m}$.
	
	Quindi abbiamo dimostrato che $\M_n\otimes\M_m$ contiene i Boreliani ed è un sottoinsieme dei misurabili, perciò, ricordando la \cref{prop:CompletamentoBoreliani}, è ovvio concluderne che il suo completamento\footnote{È fondamentale notare che la misura indotta dal prodotto e la misura di Lebesgue coincidono in virtù della \cref{prop:UnicitaCaratheodory} e di conseguenza anche l'operatore di completamento di una \sigalg{} è coincidente.} $\overline{\M_n\otimes\M_m}$ coincide con l'insieme dei misurabili.
\end{proof}


\begin{proposition}\label{prop:IntegraleRiemannCoincide}
	Data una funzione $f:\cc ab\to \mathbb R$, se essa è integrabile secondo Riemann ed integrabile secondo Lebesgue allora i due integrali coincidono.
\end{proposition}
\begin{proof}
	Nel caso in cui la funzione sia integrabile secondo Riemann (e quindi anche limitata, dando senso agli $\inf,\sup$ che compariranno nelle formule), il valore dell'integrale secondo Riemann corrisponde all'estremo superiore delle somme inferiori alla Riemann\footnote{Indicheremo con $\int_a^b$ l'integrale di Riemann, e con $\int_{\cc ab}$ l'integrale di Lebesgue}
	\begin{equation*}
		\int_a^b f(x)\de x=\sup\left\{\sum_{i=0}^{k-1} (x_{i+1}-x_i)\left(\inf_{t\in\co{x_i}{x_{i+1}}}f(t)\right):\ a=x_0<x_1<\cdots<x_{k-1}<x_k=b\right\} \virgola
	\end{equation*}
	ed anche all'estremo inferiore delle somme superiori alla Riemann
	\begin{equation*}
		\int_a^b f(x)\de x=\inf\left\{\sum_{i=0}^{k-1} (x_{i+1}-x_i)\left(\sup_{t\in\co{x_i}{x_{i+1}}}f(t)\right):\ a=x_0<x_1<\cdots<x_{k-1}<x_k=b\right\} \punto
	\end{equation*}
	
	Data una partizione $a=x_0<x_1<\cdots<x_{k-1}<x_k=b$ dell'intervallo $\cc ab$, definiamo le funzioni
	\begin{align*}
		f^-_{x_0,x_1,\dots,x_k}(x)=\sum_{i=0}^{k-1}\chi_{\co{x_i}{x_{i+1}}}(x)\cdot\inf_{t\in\co{x_i}{x_{i+1}}}f(t) \virgola \\
		f^+_{x_0,x_1,\dots,x_k}(x)=\sum_{i=0}^{k-1}\chi_{\co{x_i}{x_{i+1}}}(x)\cdot\sup_{t\in\co{x_i}{x_{i+1}}}f(t) \punto
	\end{align*}

	Con le definizioni mostrate è facile accorgersi che l'integrale di Riemann allora è l'estremo superiore dell'integrale di Lebesgue delle funzioni semplici $f^-_{x_0,\dots,x_k}$ su tutte le partizioni e analogamente l'estremo inferiore dell'integrale di Lebesgue delle funzioni semplici $f^+_{x_0,\dots,x_k}$ ancora su tutte le partizioni.
	Allora, per la monotonia dell'integrale di Lebesgue è facile accorgersi che
	\begin{multline*}
		\int_{\cc ab}f(x)\de x\le \\
		\inf_{a=x_0<\dots<x_k=b}\left\{\int_{\cc ab}f^+_{x_0,\dots,x_k}(x)\de x\right\}
		=\int_a^b f(x)\de x= 
		\sup_{a=x_0<\dots<x_k=b}\left\{\int_{\cc ab}f^-_{x_0,\dots,x_k}(x)\de x\right\}\\
		 \le \int_{\cc ab} f(x)\de x
	\end{multline*}
	e ciò equivale ovviamente alla tesi.
\end{proof}

Dimostriamo ora un caso particolare, ma molto significativo, della formula del cambio di variabile. 
Proviamo la formula per il cambio di variabile lineare che verrà poi sfruttata, attraverso una sorta di passaggio al limite, per dimostrare la formula più generale.

In particolare, e tale procedimento verrà ripetuto varie volte in questa sezione, prima otterremo un risultato sulla misura di un insieme trasformato da un'applicazione lineare per poi ricavarne facilmente la formula per il cambio di variabile. L'idea che sta alla base di questo è che l'identità riguardante le misure è in realtà un cambio di variabile riguardante le funzioni indicatrici.

\begin{proposition}\label{prop:MisuraImmagineLineare}
	Fissata un'applicazione lineare $L:\R^n\to\R^n$, per ogni $E\in\M_n$ misurabile secondo Lebesgue risulta che $L(E)$ è misurabile e rispetta
	\begin{equation}
		m_n(L(E))=\lvert \det L\rvert\cdot m_n(E)\punto
	\end{equation}
\end{proposition}
\begin{proof}
	La funzione $L$ essendo lineare è in particolare Lipschitziana (con costante la propria norma) quindi, applicando la \cref{prop:LipschitzTengonoMisurabili}, otteniamo che per ogni $E$ misurabile, $L(E)$ è anch'esso misurabile.
	
	Consideriamo ora la funzione $\mu_L:\M_n\to\Rpiu$ definita come $\mu_L(E)=m_n(L(E))$. Per quanto appena mostrato questa è una buona definizione.
	Per la \cref{prop:BigettivaInduceMisura} la $\mu_L$ è una misura.
	Inoltre, ricordando che la misura di Lebesgue è invariante per traslazione come mostrato nella \cref{nota:LebesgueProprieta}, si ottiene
	\begin{equation*}
		\forall v\in\R^n:\ \mu_L(E+v)=m_n(L(E+v))=m_n(L(E)+Lv)=m_n(L(E))=\mu_L(E)
	\end{equation*}
	che equivale a dire che $\mu_L$ è invariante per traslazione.
	\newcommand{\linR}{\ensuremath{\mathcal L(\R^n,\R^n)}}
	Allora possiamo applicare il \cref{thm:LebesgueUnicaInvarianteTraslazione}\footnote{Il teorema ci assicura l'identità delle misure solo sui Boreliani, ma i misurabili sono il completamento dei Boreliani e perciò le due misure coincidono anche sui misurabili.} ottenendo che esiste una funzione $c:\linR\to\Rpiu$ con dominio le applicazioni lineari, tale che valga
	\begin{equation}\label{eq:DefQuasiDet}
		\forall L\in \linR,\ E\in\M_n:\ \mu_L(E)=c(L)m_n(E)\punto
	\end{equation}
	
	Mostriamo ora che $c(\cdot)$ è moltiplicativa e che coindice con il valore assoluto del determinante sulle applicazioni diagonali e ortogonali. Da questo, sfruttando una decomposizione nota delle applicazioni lineari di $\R^n$, seguirà che coincide con il valore assoluto del determinante su ogni applicazione lineare e questo è proprio quanto richiesto dalla tesi. 
	
	Fissate $A,B\in \linR$ applicazioni lineari ed $E\in\M_n$ un misurabili non trascurabile, applicando unicamente l'\cref{eq:DefQuasiDet} risulta
	\begin{align*}
		c(AB)m_n(E)&=\mu_{AB}(E)=m_n(AB(E))=m_n(A(B(E))\\
		&=\mu_A(B(E))=c(A)m_n(B(E))=c(A)\mu_B(E)=c(A)c(B)m_n(E)\virgola
	\end{align*}
	da cui si ricava $c(AB)=c(A)c(B)$ dividendo per $m_n(E)$. Perciò $c$ è moltiplicativa.
	
	Sia $D\in\linR$ un'applicazione diagonale, in particolare siano $(\lambda_i)_{1\le i\le n}$ i valori sulla diagonale.
	Allora è facile ricavare
	\begin{equation*}
		D\left(\co01\times\co01\times\dots\times\co01\right)=\co0{\lambda_1}\times\co0{\lambda_2}\times\cdots\times\co0{\lambda_n}\virgola
	\end{equation*}
	da cui, applicando ad entrambi i membri la misura di Lebesgue, si ottiene
	\begin{align*}
		c(D)&=c(D)m_n\left(\co01\times\dots\times\co01\right)=\mu_D\left(\co01\times\dots\times\co01\right)\\
		&=m_n\left(\co0{\lambda_1}\times\cdots\times\co0{\lambda_n}\right)=
		\lvert\lambda_1\rvert\cdot\lvert\lambda_2\rvert\cdots\lvert\lambda_n\rvert=\lvert\det(D)\rvert
	\end{align*}
	che equivale a dire che $c(\cdot)$ e $\lvert\det(\cdot)\rvert$ coincidono sulle matrici diagonali.
	
	Fissata un'applicazione $O\in\linR$ ortogonale, chiamando $P$ la palla unitaria di $\R^n$ è ovvio che $O(P)=P$.
	Da questo, applicando ad entrambi i membri la misura di Lebesgue, si ricava $\mu_O(P)=m_n(P)$ e, ricordando che $P$ non è trascurabile, ne discende $c(O)=1$.
	Ma $O$ è ortogonale, quindi $\det O=\pm 1$ e allora è dimostrato anche in questo caso $\lvert\det O\rvert =c(O)$.
	
	Infine, data un'applicazione lineare generica $L\in\linR$, sia $L=OS$ la sua decomposizione polare\footnote{La si ottiene notando che $LL^t$ è una matrice simmetrica definita positiva che perciò ammette una ``radice quadrata''.} dove $O$ è ortogonale e $S$ è simmetrica. Per il teorema spettrale esistono $P,D$ rispettivamente invertibile e simmetrica tali che $S=PDP^{-1}$.
	Ricordando le proprietà che rispetta la funzione $c$ e la moltiplicatività del determinante, ricaviamo
	\begin{align*}
		c(L)&=c(OPDP^{-1})=c(O)c(P)c(D)c(P^{-1})=c(O)c(D)c(P)c(P^{-1})\\
		&=c(O)c(D)c(PP^{-1})=\lvert\det O\rvert\cdot\lvert\det D\rvert=\lvert \det(OPDP^{-1})\rvert=\lvert\det L\rvert \virgola
	\end{align*}
	che è equivale a dire che $c(\cdot)$ e $\lvert\det(\cdot)\rvert$ coincidono come si voleva.
\end{proof}

\begin{corollary}\label{cor:CambioVariabileLineare}
	Fissata un'applicazione lineare $L:\R^n\to\R^n$, per ogni $E\in\M_n$ misurabile ed $f:\R^n\to\Rbar$ integrabile vale la formula per il cambio di variabile lineare
	\begin{equation*}
		\int_{L(E)}f(y)\de m_n(y) = \int_E f(L(x))\left\lvert\det L\right\rvert \de m_n(x) \punto
	\end{equation*}
\end{corollary}
\begin{proof}
	Sia $\mathcal F\subseteq \L(\R^n,\M_n,m_n)$ l'insieme delle funzioni che rispettano l'enunciato.
	
	Assumendo che $f$ sia l'indicatrice di un insieme $A\in\M_n$, applicando la \cref{prop:MisuraImmagineLineare}, otteniamo
	\begin{multline*}
		\int_{L(E)}f(y)\de m_n(y)=m_n\left( A\cap L(E) \right)=m_n\left(L(L^{-1}(A)\cap E)\right)\\
		=\left\lvert\det L\right\rvert m_n\left(L^{-1}(A)\cap E\right)=\int_E f(L(x))\left\lvert\det L\right\rvert \de m_n(x) \virgola
	\end{multline*}
	cioè le indicatrici appartengono a $\mathcal F$.
	
	Per la linearità dell'operatore integrale è chiaro che l'insieme delle funzioni che rispettano è uno spazio vettoriale ed inoltre per il \cref{thm:BeppoLevi} è ovvio che $\mathcal F$ è chiuso per convergenza monotona (ammesso di rimanere nelle integrabili).
	
	Unendo quanto detto, abbiamo tutte le ipotesi per applicare il \cref{thm:ChiusuraMonotonaFunzioni}\footnote{Bisogna notare che qui sfruttiamo una versione leggermente diversa dell'enunciato, la cui dimostrazione è analoga. Infatti noi ci interessiamo ad ottenere che $\mathcal F$ coincida con le funzioni integrabili, non con tutte le misurabili. 
	Perciò l'enunciato del teorema utilizzato andrebbe modificato aggiungendo il fatto che la convergenza monotona sia ristretta nelle integrabili.} e ottenerne quindi che $\mathcal F=\L(\R^n,\M_n,m_n)$, cioè la tesi.
\end{proof}

I fatti seguenti sono tutti mirati a fornire basi solide ai vari procedimenti di limite necessari per ottenere la formula per il cambio di variabile.
%TODO: aldilà o al di là
In particolare la continuità $L^1$, così è nota in letteratura la \cref{prop:ContinuitaL1}, oltre ad essere il fondamento di tutti gli altri lemmi è importante anche aldilà di questa dimostrazione. È infatti un fatto assolutamente non ovvio che rende possibile ottenere tutti i risultati riguardo la convoluzione integrale.

Bisogna porre un accento sul fatto che la dimostrazione della continuità $L^1$ ricalca quella che vuole essere la struttura di tutte le dimostrazioni fondazionali della teoria della misura: si inizia dimostrando l'enunciato per insiemi nel \semiring{} per poi concludere che vale per ogni misurabile attraverso l'applicazione di chiusure monotone.



\begin{lemma}\label{lemma:ContinuitaL1Semianello}
	Dato $T=\co{a_1}{b_1}\times\cdots\times\co{a_n}{b_n}\in\S_n$ e $c=(c_1,\dots,c_n)\in\R^n$, vale la stima
	\begin{equation*}
		\LNorm{\chi_T({}\cdot{}+c)-\chi_T({}\cdot{})}\le 2m_n(T)\sum_{i=1}^n \frac{\lvert c_j\rvert }{b_i-a_i} \punto
	\end{equation*}
\end{lemma}
\begin{proof}
	Definiamo la funzione misurabile $s_c:\R^n\to\R$ come $s_c(x)=\left\lvert\chi_T(x+c)-\chi_T(x)\right\rvert$.
	
	Sfruttando delle identità insiemistiche e la definizione delle funzioni caratteristiche, è facile verificare che
	\begin{equation*}
		s_c(x)=\chi_{T\setminus\left(T-c\right)}(x)+\chi_{\left(T-c\right)\setminus T}(x)\punto
	\end{equation*}
	Inoltre i due insiemi $T\setminus\left(T-c\right)$ e $\left(T-c\right)\setminus T$ hanno la stessa misura in virtù della \cref{prop:LebesgueProprietaIsometria}, in quanto si può ottenere l'uno dall'altro, a meno del bordo che è però trascurabile, con un'isometria.
	Unendo quanto detto e ricordando che l'integrale di una caratteristica è la misura dell'insieme, è evidente la validità della formula
	\begin{equation} \label{eq:IdentitaIntegraleContinuitaL1}
		\LNorm{s_c}=2m_n\left(T\setminus\left(T-c\right)\right)\punto
	\end{equation}
	
	Vogliamo quindi stimare la misura di $T\setminus\left(T-c\right)$. 
	Se $x=(x_1,\dots,x_n)\in\R^n$ appartiene a $T\setminus\left(T-c\right)$ allora $x\in T$ e $x\not\in T-c$. Ma tali appartenenze, passando in coordinate, divengono il seguente sistema:
	\begin{equation}\label{eq:SistemaSemianelloContinuitaL1}
		\begin{cases}
			\forall i\in\{1,\dots,n\}: &a_i\le x_i<b_i \virgola\\
			\exists j\in\{1,\dots,n\}: &x_j<a_j-c_j \vee b_j-c_j\le x_j \punto
		\end{cases}
	\end{equation}
	Definiamo quindi $T_j$, con $j\in\{1,\dots,n\}$, come l'insieme dei punti che rispettano il sistema dove la proprietà nella seconda riga è rispettata da $j$.
	Allora, per la subadditività della misura di Lebesgue, vale
	\begin{equation}\label{eq:StimaInsiemeConPezzettiContinuitaL1}
		T\setminus\left(T-c\right)\subseteq \bigcup_{j=1}^n T_j \implies m_n\left(T\setminus\left(T-c\right)\right)\le \sum_{j=1}^n m_n(T_j) \punto
	\end{equation}
	Preso $x\in T_j$ se $c_j\ge 0$, come conseguenza dell'\cref{eq:SistemaSemianelloContinuitaL1}, vale $b_j-c_j\le x_j<b_j$; mentre se $c_j<0$ risulta $a_j\le x_j<a_j-c_j$. Sia allora $I$ l'intervallo $\co{b_j-c_j}{b_j}$, nel caso in cui $c_j\ge 0$, e $\co{a_j}{a_j-c_j}$ altrimenti. In entrambi i casi la lunghezza di $I$ risulta essere $\lvert c_j \rvert$.
	Per quanto detto, ricordando ancora l'\cref{eq:SistemaSemianelloContinuitaL1} è facile accorgersi che vale
	\begin{equation*}
		T_j\subseteq \co{a_1}{b_1}\times\cdots\times\co{a_{j-1}}{b_{j-1}}\times I\times\co{a_{j+1}}{b_{j+1}}\times\cdots\times \co{a_n}{b_n}
	\end{equation*}
	e da questa, per la definizione della misura di Lebesgue su $\S_n$ è ovvio ricavarne
	\begin{equation}\label{eq:StimaFinalePezzettoContinuitaL1}
		m_n(T_j)\le \frac{\lvert c_j\rvert }{b_j-a_j} \prod_{i=1}^n (b_i-a_i)=\frac{\lvert c_j\rvert }{b_j-a_j} m_n(T) \punto
	\end{equation}
	
	Unendo le \cref{eq:IdentitaIntegraleContinuitaL1,eq:StimaInsiemeConPezzettiContinuitaL1,eq:StimaFinalePezzettoContinuitaL1} arriviamo finalmente ad avere
	\begin{equation*}
		\LNorm{s_c}\le 2m_n(T)\sum_{i=1}^n \frac{\lvert c_j\rvert }{b_i-a_i}\virgola
	\end{equation*}
	che implica che la tesi per definizione di $s_c$.
\end{proof}


\begin{proposition}[Continuità $L^1$]\label{prop:ContinuitaL1}
	Data una funzione $f:\R^n\to\Rbar$ integrabile nella misura di Lebesgue, le funzioni $f({}\cdot{}+c)$ convergono, per $c$ che tende a $0$, in norma $L^1$ ad $f$.
\end{proposition}
\begin{proof}
	Sia $\mathcal F\subseteq \L(\R^n,\M_n,m_n)$ l'insieme delle funzioni integrabili per cui l'enunciato è vero.
	Chiamiamo poi, per $c\in\R^n$, $\tau_c:\R^n\to\R^n$ la traslazione $\tau_c(x)=x+c$.
	
	Dimostreremo che le funzioni indicatrici di $\S_n$ appartengono ad $\mathcal F$, poi che $\mathcal F$ è uno spazio vettoriale chiuso per convergenga puntuale ed infine che se due funzioni coincidono quasi ovunque ed una appartiene ad $\mathcal F$ allora anche l'altra vi appartiene. 
	L'unione di questi fatti sarà sufficiente a mostrare che $\mathcal F=\L(\R^n,\M_n,m_n)$ dimostrando così la tesi.
	
	Il \cref{lemma:ContinuitaL1Semianello} dimostra banalmente, considerando il limite per $c\to 0$, che le indicatrici degli insiemi in $\S_n$ appartengono ad $\mathcal F$.
	
	Il fatto che $\mathcal F$ sia uno spazio vettoriale discende direttamente dalla linearità dell'integrale e dal fatto che il limite di una somma è la somma dei limiti.
	
	Sia $(f_n)_{n\in\N}$ una successione di funzioni integrabili che appartengono ad $\mathcal F$ e sia $f$ il limite puntuale di tale successione, che assumiamo essere integrabile.
	Per il \cref{thm:ConvergenzaDominata}, le cui ipotesi sono facilmente verificate poichè $f$ è integrabile, le $f_n$ convergono ad $f$ anche in norma $L^1$ e perciò, per ogni $\epsilon>0$, esiste $m\in\N$ tale che $\LNorm{f_m-f}<\epsilon$. 
	Inoltre, una facile conseguenza dell'invarianza per traslazione della misura di Lebesgue è 
	\begin{equation*}
		\LNorm{f_m\circ\tau_c-f\circ\tau_c}=\LNorm{f_m-f} \virgola
	\end{equation*}
	da cui, poichè $\LNorm{{}\cdot{}}$ rispetta la triangolare come mostrato nella \cref{prop:L1VettorialeConSeminorma}, ne otteniamo
	\begin{equation*}
		\LNorm{f\circ\tau_c-f}\le \LNorm{f_m\circ\tau_c-f\circ\tau_c}+\LNorm{f_m-f}+\LNorm{f_m\circ\tau_c-f_m} \le 2\epsilon+\LNorm{f_m\circ\tau_c-f_m}\virgola
	\end{equation*}
	che passando al massimo limite entrambi i membri e ricordando che $f_n\in\mathcal F$, implica la disuguaglianza
	\begin{equation*}
		\limsup_{c\to 0} \LNorm{f\circ\tau_c-f} \le 2\epsilon \punto
	\end{equation*}
	Ma quest'ultima disuguaglianza vale per ogni $\epsilon>0$ e ciò implica ovviamente che anche $f\in\mathcal F$.
	
	Date $f,g:\R^n\to\Rbar$ funzioni integrabili equivalenti in $L^1$, con $f\in\mathcal F$, dimostriamo che $g\in\mathcal F$. 
	Anche $f\circ\tau_c$ e $g\circ\tau_c$ sono equivalenti in $L^1$ e perciò anche $f\circ\tau_c-f$ coincide quasi ovunque con $g\circ\tau_c-g$.
	Unendo quanto detto si ottiene
	\begin{equation*}
		\LNorm{g\circ\tau_c-g}=\LNorm{f\circ\tau_c-f}\to 0 \virgola
	\end{equation*}
	che implica che anche $g$ appartiene a $\mathcal F$.
	
	Sia $\mathcal E$ la famiglia degli insiemi tali che le loro indicatrici appartengono ad $\mathcal F$. 
	
	Abbiamo mostrato che $\S_n\subseteq \mathcal E$. 
	Inoltre il fatto che $\mathcal F$ sia uno spazio vettoriale implica che $\mathcal E$ sia stabile per unione disgiunta e, essendo $\mathcal F$ chiuso per convergenza puntuale nelle funzioni integrabile, $\mathcal E$ risulta stabile per unione e intersezione monotona numerabile negli insiemi finiti.
	Quindi risultano verificate le ipotesi del \cref{cor:ChiusuraMonotonaInsiemiFiniti} e ne deduciamo che $\mathcal E$ contiene ogni misurabile finito a meno di un trascurabile. Ma il fatto che se $\mathcal F$ contiene una funzione allora contiene ogni funzione che coincide quasi ovunque con essa implica che $\mathcal E$ se contiene un insieme allora contiene anche quelli che coincidono con lui a meno di un trascurabile.
	Quindi questo implica $\mathcal E$ contiene tutti gli insiemi misurabili finiti e perciò $\mathcal F$ contiene le loro indicatrici.
	
	Concludiamo quindi applicando il \cref{thm:ChiusuraMonotonaFunzioni}\footnote{Di nuovo sfruttiamo l'enunciato nella forma con insiemi finiti e funzioni integrabili.}, di cui abbiamo controllato essere verificate tutte le ipotesi, e otteniamo che $\mathcal F$ contiene tutte le funzioni integrabili.
\end{proof}

\begin{definition}[Media integrale] \label{def:MediaIntegrale}
	Definiamo l'operatore $\aint$, chiamato media integrale, come
	\begin{equation*}
		\aint_E f(x)\de\mu(x)=\frac 1{\mu(E)}\int_E f(x)\de\mu(x)\virgola
	\end{equation*}
	dove $E$ è un insieme misurabile nello spazio di misura $(X,\A,\mu)$ e $f:X\to\Rbar$ è una funzione integrabile nel medesimo spazio di misura.
\end{definition}
\begin{remark}\label{nota:ProprietaMediaIntegrale}
	Fissato uno spazio di misura $(X,\A,\mu)$ e un insieme misurabile $E\in\A$ l'operatore di media integrale rispetta le seguenti proprietà:
	\begin{itemize}
		\item Date $f,g:X\to\Rbar$ funzioni misurabili e $a,b\in\R$ vale
		\begin{equation*}
			a\aint_E f(x)\de\mu(x)+b\aint_E g(x)\de\mu(x)=\aint_E af(x)+bg(x)\de\mu(x)
		\end{equation*}
		e se $f\le g$ allora
		\begin{equation*}
			\aint_E f(x)\de\mu(x)\le \aint_E g(x)\de\mu(x)\virgola
		\end{equation*}
		cioè la media integrale è lineare e monotona.
		\item Fissato $c\in\R$ vale
		\begin{equation*}
			\aint_E c\de\mu(x)=c\punto
		\end{equation*}
		\item Per ogni $f:X\to\Rbar$ misurabile valgono le stime
		\begin{equation*}
			\inf_{x\in E}f(x)\le \aint_E f(x)\de\mu(x) \le \sup_{x\in E}f(x)\punto
		\end{equation*}
	\end{itemize}
\end{remark}
\begin{proof}
	La linearità, la monotonia e l'identità riguardante la media integrale delle costanti discendono dalla \cref{def:MediaIntegrale} applicando le prime proprietà dell'integrale di Lebesgue.
	
	Per quanto riguarda l'ultima stima, è sufficiente applicare le proprietà già dimostrate per ottenere
	\begin{equation*}
		\inf_{x\in E}f(x) = \aint_E \inf_{x\in E} f(x)\de\mu(x)\le \aint_E f(x)\de\mu(x) \le \aint_E \sup_{x\in E} f(x)\de\mu(x) =\sup_{x\in E}f(x)\punto
	\end{equation*}
\end{proof}


\begin{lemma}\label{lemma:ContinuitaL1Palle}
	Fissato $E\in\M_n$ un insieme misurabile e $f:E\to\Rbar$ una funzione misurabile, definiamo, per ogni $r>0$, la funzione $f_r:E\to\R$ come
	\begin{equation*}
		\forall x\in E:\ f_r(x)=\frac{\int_{B_r(x)\cap E}f(t)\de t}{m_n\left(B_r(x)\right)}\virgola
	\end{equation*}
	dove $B_r(x)$ è la palla aperta di raggio $r$ e centro $x$.
	Allora le funzioni $f_r$, che risultano essere continue, convergono, per $r$ che tende a $0$, in norma $L^1$ alla funzione $f$.
\end{lemma}
\begin{proof}
	Innanzitutto, per comodità di notazione, allarghiamo il dominio della $f$ ponendo $f(E^{\mathsf c})=\{0\}$, così facendo otteniamo
	\begin{equation*}
		\forall r>0,\ x\in E:\ f_r(x)=\frac{\int_{B_r(x)}f(t)\de t}{m_n(B_r(x))}=\aint_{B_r(x)} f(t)\de t \punto
	\end{equation*}

	Vale facilmente, per ogni $x,y\in E$, l'identità
	\begin{equation*}
		\lvert f_r(x)-f_r(y)\rvert %= \left\lvert \aint_{B_r(x)}f(t)\de t-\aint_{B_r(y)} f(t)\de t\right\rvert 
		\le \aint_{B_r(x)}\lvert f(t)-f(t+(y-x))\rvert \de t \le \frac{ \LNorm{f({}\cdot{})-f({}\cdot{}+(y-x)} }{ m_n(B_r(0)) } \virgola
	\end{equation*}
	che grazie alla \cref{prop:ContinuitaL1} implica la continuità delle funzioni $f_r$.
	
	Ora verifichiamo, per poi poter applicare il teorema di Tonelli, che la funzione $g:\R^n\times\R^n\to\Rbar$ definita come $g(x,t)=f(x+t)-f(x)$ è misurabile nello spazio prodotto $\R^n\times\R^n$. 
	La funzione $u(x,t)=f(x)$ è misurabile nel prodotto grazie alla \cref{nota:FunzioniMisProdotto} e allora anche $u(x+t,t)$ lo è in quanto composizione di una misurabile con una lineare invertibile. Unendo quanto detto si ha, come cercato, che $g(x,t)=u(x+t,t)-u(x,t)$ è misurabile in quanto differenza di misurabili.
	
	Calcoliamo ora la norma $L^1$ della differenza tra $f$ e $f_r$:
	\begin{multline}\label{eq:ContinuitaPalleDis}
		\LNorm{f-f_r}=\int_E \left\lvert f(x)-\aint_{B_r(x)}f(t)\de t\right\rvert\de x\\
		=\int_E\left\lvert\aint_{B_r(x)}f(x)-f(t)\de x\right\rvert\de t\le \int_E\aint_{B_r(x)}\left\lvert f(x)-f(t)\right\rvert\de x\de t\\
		=\int_E\aint_{B_r(0)}\left\lvert f(x)-f(x+h)\right\rvert\de h\de x
		=\aint_{B_r(0)}\int_E \left\lvert f(x)-f(x+h)\right\rvert\de x\de h\\
		= \aint_{B_r(0)}\LNorm{f(\cdot)-f(\cdot+h)}\de h\le \sup_{h\in B_r(0)} \LNorm{f(\cdot)-f(\cdot+h)}\virgola
	\end{multline}
	dove nei vari passaggi abbiamo sfruttato il \cref{thm:TonelliCompleto}, che si può applicare ricordando la \cref{prop:MisuraProdottoEuclidea}, e la \cref{nota:ProprietaMediaIntegrale}.
	
	Per la \cref{prop:ContinuitaL1}, il valore $\sup_{h\in B_r(0)} \LNorm{f(\cdot)-f(\cdot+h)}$ tende a $0$ per $r\to 0$ e applicando ciò nell'\cref{eq:ContinuitaPalleDis} si ricava facilmente la tesi.
\end{proof}

Terminati i lemmi preliminari, mostriamo ora la formula per il cambio di variabile. La dimostrazione procede in tre passi. 
In un primo passo, cioè nel \cref{lemma:LimiteDeterminante}, proviamo solo una disuguaglianza, che poi mostreremo essere un'uguaglianza nel \cref{lemma:MisuraImmagine} e che sarà l'equivalente della \cref{prop:MisuraImmagineLineare} ma nel caso generale e non in quello lineare. Infine il terzo passo semplicente trasforma l'enunciato sulla misura di un insieme nella formula per il cambio di variabile.

Per passare da disuguaglianza a disuguaglianza sfrutteremo come strumento fondamentale il teorema di Radon-Nikodym, che asserisce fondamentalmente che ogni misura ammette una ``densità'' cioè una funzione tale che il suo integrale su un insieme, rispetto ad un'altra misura, coincide con la misura dell'insieme.
Tale teorema lo lasciamo indimostrato fondamentalmente per la non banalità della dimostrazione e poichè in queste dispense lo useremo solo come strumento tecnico, senza approfondire l'argomento.

\begin{lemma}\label{lemma:LimiteDeterminante}
	Fissato $\Omega\subseteq\R^n$ un aperto, sia $\varphi:\Omega\to\R^n$ una funzione differenziabile con continuità.
	Allora vale la seguente disuguaglianza:
	\begin{equation*}
		\forall x\in\Omega:\ \limsup_{r\to 0} \frac{ m_n\left(\varphi\left(B_r(x)\right)\right)} {m_n\left(B_r(x)\right)}\le \lvert\det D\varphi(x)\rvert \virgola 
	\end{equation*}
	dove $B_r(x)$ è la palla aperta di raggio $r$ e centro $x$ e $D\varphi$ è la matrice Jacobiana della funzione $\varphi$.
\end{lemma}
\begin{proof}
	Fissiamo $\bar x\in\Omega$ e chiamiamo $A=D \varphi(\bar x)$.
	Allora, per definizione di differenziale, risulta vero che
	\begin{equation*}
		\varphi(\bar x+h)=\varphi(\bar x)+Ah+\smallO(h)=\varphi(\bar x)+A(h+\smallO(h))\in \varphi(\bar x)+A\left(B_{|h|+\smallO(h)}(0)\right) \virgola
	\end{equation*}
	dove abbiamo implicitamente sfruttato che moltiplicare per la norma degli operatori di $A$ non cambia il fatto che una funzione sia $\smallO$-piccolo di un'altra.
	
	Da quanto appena detto discende facilmente che, per ogni $r>0$, vale
	\begin{equation}\label{eq:ContenimentoPallaLineare}
		\varphi(B_r(\bar x))\subseteq \varphi(\bar x)+A\left(B_{r+\smallO(r)}(0)\right).
	\end{equation}
	Essendo però $\varphi$ differenziabile con continuità, è anche localmente Lipschitziana e perciò, purchè $r$ sia sufficientemente piccolo, la funzione è Lipschitziana in $B_r(\bar x)$ e quindi, per la \cref{prop:LipschitzTengonoMisurabili}, l'insieme $\varphi(B_r(\bar x))$ è misurabile.
	Allora possiamo applicare la misura di Lebesgue ad entrambi i membri del contenimento mostrato nell'\cref{eq:ContenimentoPallaLineare} ottenendo
	\begin{equation}\label{eq:StimaImmaginePalla}
		m_n\left( \varphi(B_r(\bar x)) \right)\le m_n\left(\varphi(\bar x)+A\left(B_{r+\smallO(r)}(0)\right)\right)
		=\lvert \det A\rvert m_n\left(B_{r+\smallO(r)}(\bar x)\right)\virgola
	\end{equation}
	dove i passaggi sono giustificati dall'invarianza per traslazione della misura di Lebesgue e dalla \cref{prop:MisuraImmagineLineare}.
	Ma ora, grazie alla $n$-omogeneità della misura $m_n$, ricaviamo
	\begin{equation*} 
		m_n\left(B_{r+\smallO(r)}(\bar x)\right)=\left(1+\smallO(r)\right)^n m_n\left( B_r(\bar x)\right)
	\end{equation*}
	e perciò sostituendo questa nell'\cref{eq:StimaImmaginePalla} arriviamo a
	\begin{equation*}
		m_n\left( \varphi(B_r(\bar x)) \right)\le \left(1+\smallO(r)\right)^n m_n\left( B_r(\bar x)\right)\lvert \det A\rvert \virgola
	\end{equation*}
	che implica banalmente la tesi.
\end{proof}

\begin{definition}\label{def:AssolutamenteContinua}
	Date due misure $\mu:\A\to\Rpiu,\nu:\A\to\Rpiu$ sullo stesso spazio misurabile $(X,\A)$, diciamo che $\nu$ è assolutamente continua rispetto a $\mu$, indicandolo con $\nu\ll\mu$, se, per ogni $E\in\A$, se $\mu(E)=0$ allora $\nu(E)=0$, cioè se tutti gli insiemi trascurabili per $\mu$ sono trascurabili anche per $\nu$.
\end{definition}

\begin{theorem}[Radon-Nikodym] \label{thm:RadonNikodym}
	Dato uno spazio di misura $(X,\A,\mu)$ \sigfin[o], se la misura $\nu:\A\to\Rpiu$ è assolutamente continua rispetto a $\mu$, allora esiste una funzione $\rho:X\to\Rpiu$ misurabile rispetto a $\mu$, tale che
	\begin{equation*}
		\forall A\in\A:\ \nu(A)=\int_A \rho(x)\de\mu(x)\punto
	\end{equation*}
\end{theorem}

\begin{lemma}\label{lemma:MisuraImmagine}
	Fissati $\Omega,\Omega'\subseteq\R^n$ due aperti, sia $\varphi:\Omega\to\Omega'$ un diffeomorfismo $C^1$.
	Allora, per ogni $E\subseteq \Omega$ misurabile vale
	\begin{equation*}
		m_n(\varphi(E))=\int_E\left\lvert \det D\varphi(x) \right\rvert \de m_n(x)\virgola
	\end{equation*}
	dove $D\varphi$ è la matrice Jacobiana del diffeomorfismo $\varphi$.
\end{lemma}
\begin{proof}
	Innanzitutto scriviamo $\Omega=\bigcup_{n\in\N} K_n$ dove $(K_n)_{n\in\N}$ è una successione di compatti. 
	Allora, dato un insieme $N\subset\Omega$ trascurabile, vale
	\begin{equation*}
		\varphi(N)=\bigcup_{n\in\N} \varphi\left(N\cap K_n\right)\virgola
	\end{equation*}
	ma nei compatti $K_n$ la funzione $\varphi$, essendo $C^1$, è Lipschitziana e quindi per la \cref{prop:LipschitzTengonoMisurabili} manda trascurabili in trascurabili e perciò $\varphi\left(N\cap K_n\right)$ è trascurabile e da questo ne segue che $\varphi(N)$ è trascurabile in quanto unione numerabile di trascurabili.
	Riassumendo, la funzione $\varphi$ manda trascurabili in trascurabili e per la \cref{prop:ContinueSpecialiTengonoMisurabili} questo implica che manda misurabili in misurabili.
	
	Allora per la \cref{prop:BigettivaInduceMisura} la funzione di insiemi $\nu=m_n\circ \varphi$ è una misura, che risulta essere assolutamente continua rispetto alla misura di Lebesgue poichè $\varphi$ manda trascurabili in trascurabili.
	Perciò, per il \cref{thm:RadonNikodym}, esiste $\rho:\Omega\to\Rpiu$ integrabile tale che
	\begin{equation*}
		\forall E\in M_n\text{ t.c. } E\subseteq \Omega:\ m_n(\varphi(E))=\int_E \rho \de x \punto
	\end{equation*}
	Con una dimostrazione del tutto analoga a quella del \cref{cor:CambioVariabileLineare} questo implica che vale anche la formula
	\begin{equation}\label{eq:CambioRadonNikodym}
		\forall E\in M_n\text{ t.c. } E\subseteq\Omega:\ \int_{\varphi(E)} f(y)\de y = \int_{E} f(\varphi(x))\rho(x) \de x
	\end{equation}
	per ogni $f:\Omega\to\Rbar$ integrabile.
	
	A questo punto, usando la medesima notazione dell'enunciato del \cref{lemma:ContinuitaL1Palle}, notiamo che
	\begin{equation*}
		\rho_r(x)=\aint_{B_r(x)}\rho(t)\de t=\frac{\int_{B_r(x)} \rho(t)\de t}{m_n(B_r(0))}=\frac{m_n(\varphi(B_r(x)))}{m_n(B_r(0))}\virgola
	\end{equation*}
	e quindi, applicando proprio il \cref{lemma:ContinuitaL1Palle}, otteniamo che $\frac{m_n(\varphi(B_r(x)))}{m_n(B_r(0))}$ converge a $\rho$ in norma $L^1$ per $r$ che tende a $0$.
	Ricordando però la \cref{prop:L1ImplicaSottosuccessioneQuasiOvunque}, abbiamo anche che $\frac{m_n(\varphi(B_r(x)))}{m_n(B_r(0))}$ converge puntualmente quasi ovunque a $\rho$. Perciò, notando che se esiste il limite coincide con il limite superiore, possiamo applicare il \cref{lemma:LimiteDeterminante} ed ottenere che per quasi ogni $x\in\Omega$ vale
	\begin{equation}\label{eq:DisuguaglianzaRadonNikodym}
		\rho(x)=\limsup_{r\to 0} \frac{ m_n\left(\varphi\left(B_r(x)\right)\right)} {m_n\left(B_r(x)\right)}\le \lvert\det D\varphi(x)\rvert \punto
	\end{equation}
	
	Ora, unendo le due \cref{eq:CambioRadonNikodym,eq:DisuguaglianzaRadonNikodym}, arriviamo a dire che per ogni $f:\Omega\to\Rbar$ misurabile positiva vale
	\begin{equation*}
		\forall E\in M_n\text{ t.c. } E\subseteq\Omega:\ \int_{\varphi(E)} f(y)\de y\le 
		\int_E f(\varphi(x))\left\lvert\det D\varphi(x)\right\rvert\de x \punto
	\end{equation*}
	
	Ora giungiamo alla disuguaglianza conclusiva applicando quest'ultima stima sia alla funzione $\varphi$ sia alla funzione $\varphi^{-1}$ che essendo per ipotesi anch'esso un diffeomorfismo $C^1$ rispetterà un analogo enunciato.
	Seguendo lo schema enunciato otteniamo che per ogni $E\subseteq\Omega$ misurabile vale
	\begin{multline*}
		m_n(E) =\int_{\varphi(\varphi^{-1}(E))}1\de x\le \int_{\varphi^{-1}(E)} \left\lvert\det D\varphi(x)\right\rvert\de x \\
 		\le \int_E \left\lvert\det D\varphi(\varphi^{-1}(x))\right\rvert \cdot \left\lvert\det D\varphi^{-1}(x)\right\rvert\de x =\int_E 1\de x=m_n(E) \virgola
	\end{multline*}
	dove abbiamo applicato implicitamente la formula del differenziale dell'inversa e la moltiplicatività del determinante.
	Però, poichè primo e ultimo membro coincidono, tutte le disuguaglianze della catena devono essere uguaglianze e da questo ricaviamo
	\begin{equation*}
		m_n(E)=\int_{\varphi^{-1}(E)} \left\lvert\det D\varphi(x)\right\rvert\de x \virgola
	\end{equation*}
	che implica banalmente la tesi.
\end{proof}

\begin{theorem}\label{thm:CambioVariabile}
	Fissati $\Omega,\Omega'\subseteq\R^n$ due aperti, sia $\varphi:\Omega\to\Omega'$ un diffeomorfismo $C^1$.
	Allora, per ogni $E\subseteq \Omega$ misurabile e $f:\Omega'\to\R$ integrabile, vale
	\begin{equation*}
		\int_{\varphi(E)} f(y)\de m_n(y) = \int_{E} f(\varphi(x))\lvert \det D\varphi(x) \rvert \de m_n(x) \virgola
	\end{equation*}
	dove $D\varphi$ è la matrice Jacobiana del diffeomorfismo $\varphi$.
\end{theorem}
\begin{proof}
	La dimostrazione è completamente analoga a quella del \cref{cor:CambioVariabileLineare}, solo che al posto di sfruttare la \cref{prop:MisuraImmagineLineare} si sfrutta il \cref{lemma:MisuraImmagine}.
\end{proof}

