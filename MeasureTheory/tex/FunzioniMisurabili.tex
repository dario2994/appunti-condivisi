\section{Funzioni misurabili}

In questa sezione daremo la definizione di funzione misurabile e dimostreremo alcuni fatti basilari su di esse.
La teoria delle funzioni misurabili, oltre ad essere strettamente necessaria per la successiva teoria dell'integrazione, ci permetterà di dimostrare che i misurabili secondo Lebesgue, introdotti nella sezione precedente, non coincidono con i Boreliani, che era una questione lasciata in sospeso in precedenza per mancanza degli strumenti necessari a dimostrarlo.

\begin{definition}[Funzione misurabile]
	Dato uno spazio di misura $(X,\A,\mu)$, una funzione $f:X\rightarrow \Rbar$ si dice misurabile se
	$\forall A \subseteq \Rbar$ aperto si ha $f^{-1}(A)\in \A$.
\end{definition}

\begin{proposition}
	\label{BasicMis}
	Dato uno spazio di misura $(X,\A,\mu)$, sia $f:X\rightarrow \Rbar$ una funzione, sono equivalenti i seguenti fatti
	\footnote{qui introduciamo la notazione per i \textit{sovralivelli} di una funzione che useremo in tutti gli appunti:
		data una funzione $f$ di codominio reale e un certo reale $k$ indichiamo con $\{f>k\}$ l'insieme
		$\{x:f(x)>k\}=f^{-1}((k,+\infty])$; stessa notazione verrà usata anche per il sottolivello}:
	\begin{enumerate}[label=(\arabic*),ref=(\arabic*)]
		\item $f$ è misurabile; \label{BM:mis}
		\item $\{f<a\}\in \A \quad \forall a\in \Rbar$; \label{BM:sot}
		\item $\{f\leq a\}\in \A \quad \forall a\in \Rbar$; \label{BM:soteq}
		\item $\{f>a\}\in \A \quad \forall a\in \Rbar$; \label{BM:sov}
		\item $\{f\geq a\}\in \A \quad \forall a\in \Rbar$;  \label{BM:soveq}
		\item $\{a<f<b\}\in \A \quad \forall a,b\in \Rbar$; \label{BM:int}
	\end{enumerate}
\end{proposition}
\begin{proof}
	Sfruttando le proprietà di $\A$ come \sigalg, mostriamo a catena tutte le implicazioni:
	\begin{description}
	\item[\ImplicationProof{BM:mis}{BM:sot}] per definizione di misurabile, $\{f<a\}=f^{-1}([-\infty,a))\in \A$,
		perché $[-\infty,a)$ è aperto;
	\item[\ImplicationProof{BM:sot}{BM:soteq}] poiché $[-\infty,a]=\bigcap_{n\in \N}[-\infty,a+\frac{1}{n})$, allora otteniamo che
		$\{f\leq a\}=f^{-1}([-\infty,a])=\bigcap_{n\in \N}f^{-1}([-\infty,a+\frac{1}{n}))\in \A$
	\item[\ImplicationProof{BM:soteq}{BM:sov}] passando al complementare, $\{f>a\}^\mathsf{c}=\{f\leq a\}\in \A$;
	\item[\ImplicationProof{BM:sov}{BM:soveq}] analogamente a \ImplicationProof{BM:sot}{BM:soteq}; 
	\item[\ImplicationProof{BM:soveq}{BM:sot}] analogamente a \ImplicationProof{BM:soteq}{BM:sov};
	\item[$\text{\ref{BM:sot}}\ +\ \text{\ref{BM:sov}}\implies\text{\ref{BM:int}}$] perché
		$\{a<f<b\}=\{a<f\}\cap\{f<b\}\in \A$;
	\item[\ImplicationProof{BM:int}{BM:mis}] perché un aperto $A\subseteq\Rbar$ si può scrivere come
		$A=\bigcup_{n\in \N}A_n$ dove ciascun $A_n$ è un intervallo aperto di $\Rbar$ (o una semiretta aperta);
		quindi $f^{-1}(A)=\bigcup_{n\in \N}f^{-1}(A_n)\in \A$, perché per il punto \ref{BM:int} $f^{-1}(A_n)\in \A\ \ \forall n$.
	\end{description}
\end{proof}

\begin{proposition}
	\label{CounterImgMis}
	Dato uno spazio di misura $(X,\A,\mu)$, e data $f:X\rightarrow \Rbar$ una funzione misurabile, la famiglia di insiemi
	\[
		\mathcal{E} = \{ E\subseteq \Rbar : f^{-1}(E)\in \A \}
	\]
	è una \sigalg{} ed inoltre contiene i Boreliani.
\end{proposition}
\begin{proof}
	Verifichiamo che $\mathcal E$ è stabile per unioni numerabili e passaggio al complementare.
	
	Fissati $\{E_n\}_{n\in \N}\subseteq \mathcal{E}$ sia $E = \cup_{n\in \N}E_n$, vale:
	\begin{equation*}
		f^{-1}(E)=f^{-1}\left(\cup_{n\in \N}E_n\right) = \cup_{n\in \N}f^{-1}(E_n)\in \A \implies E \in \mathcal{E}
	\end{equation*}
	dove l'appartenenza ad $\A$ si ha per le proprietà di \sigalg{}, e questo dimostra la stabilità per unione numerabile.
	
	Per quanto riguarda il passaggio al complementare, fissato $E\in \mathcal{E}$, risulta:
	\begin{equation*}
		f^{-1}(E^\mathsf{c})= f^{-1}(E)^\mathsf{c} \in \A \implies E^\mathsf{c} \in \mathcal{E}.
	\end{equation*}
	
	Inoltre $\mathcal E$ contiene gli aperti per definizione di funzione misurabile, da cui, per quanto appena dimostrato, contiene la \sigalg{} generata da questi, cioè i Boreliani.
\end{proof}

\begin{proposition}
	\label{AlgMis}
	Dato uno spazio di misura $(X,\A,\mu)$, sia $\mathcal{M}=\{f:X\rightarrow \Rbar : f\ \grave{e} \ misurabile\}$.
	Allora $\mathcal{M}$ è un'algebra nel senso che, dove sono definite,
	\footnote{Nel definire le operazioni algebriche su $\mathcal{M}$ adottiamo le seguenti convenzioni: la somma è definita
		se non accade che entrambe $f$ e $-g$ siano $\pm\infty$, per la moltiplicazione $0\cdot \infty = 0$.}
	valgono le seguenti:
	\begin{enumerate}[label=(\arabic*),ref=(\arabic*)]
		\item $f,g\in \mathcal{M} \Rightarrow f+g\in \mathcal{M}$; \label{AlM:sum}
		\item $f\in \mathcal{M}, \lambda \in \R \Rightarrow \lambda f\in \mathcal{M}$. \label{AlM:sca}
		\item $f,g\in \mathcal{M} \Rightarrow fg\in \mathcal{M}$. \label{AlM:pro}
	\end{enumerate}
\end{proposition}

\begin{proof}
	Mostriamo per ogni punto che vale la proposizione \ref{BM:sov} in \cref{BasicMis} (che come lì mostrato, equivale alla misurabilità),
	distinguendo vari casi di $a\in \Rbar$.
	\begin{description}
	\item[\ref{AlM:sum}]
	\[
		\{f+g>a\}=\left\{\begin{array}{ll}
			\{f=-\infty\}\cap\{g=-\infty\}\in \A &\qquad se\ a=-\infty;\\
			\bigcup_{q\in \Q}\left(\{f>q\}\cap\{g>a-q\}\right)\in \A &\qquad se\ a\in \R;\\
			\{f=+\infty\}\cup\{g=+\infty\}\in \A &\qquad se\ a=+\infty.
		\end{array}\right.
	\]
	\item[\ref{AlM:sca}]
	\[
		\{\lambda f>a\}=\left\{\begin{array}{ll}
			\left\{f<\frac{a}{\lambda}\right\}\in \A &\qquad se\ \lambda<0;\\
			\Rbar \in \A &\qquad se\ \lambda=0\ e\ a< 0;\\
			\emptyset \in \A &\qquad se\ \lambda=0\ e\ a\geq 0;\\
			\left\{f>\frac{a}{\lambda}\right\}\in \A &\qquad se\ \lambda>0.
		\end{array}\right.
	\]
	\item[\ref{AlM:pro}] Per ogni funzione $h$ possiamo scrivere la parte positiva $h^+ = \max\{h,0\}$ e la parte negativa $h^- = \max\{0,-h\}$,
	così $h^+,h^- \geq 0$ e $h = h^+ - h^-$. 
	
	Ora scomponiamo $f=f^+ - f^-$, $g=g^+- g^-$, quindi la funzione prodotto $fg$ si scrive come una qualche combinazione di prodotti di funzioni non negative. Grazie ai punti \ref{AlM:sum} e \ref{AlM:sca} e a questa osservazione ci basta mostrare il caso in cui $f,g\geq0$:
	\[
		\{fg>a\}=\left\{\begin{array}{ll}
			\Rbar\in \A &\quad se\ a<0;\\
			\{f=0\}\cup\{g=0\}\in \A &\quad se\ a=0;\\
			\bigcup_{q\in \Q^+}\left(\{q<f<+\infty\}\cap\left\{\frac{a}{q}<g<+\infty \right\} \right)\in \A &\quad se\ 0<a<+\infty;\\
			(\{f=+\infty\}\cap\{g>0\})\cup (\{f>0\}\cap\{g=+\infty\})\in \A &\quad se\ a=+\infty.
		\end{array}\right.
	\]
	\end{description}
\end{proof}

\begin{remark}
	\label{CarMis}
	È facile vedere che le funzioni caratteristiche degli insiemi misurabili sono misurabili.
\end{remark}
\begin{proof}
	Basta osservare che se $A\in \A$ è misurabile, $\{ \chi_A > a\}$ può valere solo $\emptyset$, $A$, $X$ (tutti e 3 misurabili) a seconda che
	$a\geq 1$, $a\geq 0$ oppure $a < 0$ rispettivamente.
\end{proof}

\begin{remark}\label{ContinueMisurabili}
	Sia $X$ un insieme dotato sia di una topologia che di una misura su di esso, tali che in particolare la \sigalg{} dei misurabili contenga tutti gli aperti.
	Data una funzione $f:X\to\R$, se $f$ è continua è anche misurabile.
\end{remark}
\begin{proof}
	Basta notare che la controimmagine di un aperto è un aperto per continuità, ma gli aperti sono misurabili per ipotesi e di conseguenza la funzione è misurabile.
\end{proof}

\begin{remark}\label{MonotoneMisurabili}
	Fissato $A\subseteq \R$ misurabile, ogni funzione $f:A\to\R$ monotona è misurabile, munendo $\R$ della misura di Lebesgue definita nella precedente sezione.
\end{remark}
\begin{proof}
	È sufficiente notare che la controimmagine di un intervallo \footnote{Definiamo, unicamente in questa dimostrazione, un intervallo come un generico sottoinsieme connesso di \R.} è a sua volta un intervallo intersecato $A$ poichè la funzione è monotona, perciò applicando \cref{BasicMis} ricaviamo che la funzione è misurabile visto che gli intervalli sono misurabili secondo Lebesgue (e lo è la loro interesezione con $A$, per la \cref{RiduzioneMisura}).
\end{proof}

\begin{proposition}\label{BorelianiNonMisurabili}
	La \sigalg{} dei Boreliani non coincide con la \sigalg{} dei misurabili secondo Lebesgue.
\end{proposition}
\begin{proof}
	Definiamo la funzione $f:\co{0}{1}\to \co{0}{1}$ in modo che $f(x)$ sia il numero che corrisponde alla lettura in base $3$ della scrittura in base $2$ di $x$.
	Poichè alcuni numeri hanno due scritture in base $2$, sceglieremo sempre quella che non ha una coda infinita di $1$.
	
	Qui di seguito un diagramma che mostra la definizione di $f$:
	\begin{equation*}
		x=\>\stackrel{\text{Scrittura in base $2$ di $x$}}{\overline{0.x_1x_2x_3\cdots}_2} \>  \longmapsto
		\> \stackrel{\text{Lettura in base $3$ di $x$ in base $2$}}{\overline{0.x_1x_2x_3\cdots}_3}\>=f(x)
	\end{equation*}

	La funzione $f$ appena definita è strettamente crescente, poichè lo è la funzione che associa ad un numero $x$ la sua lettura in qualche base (dove le sequenze di cifre sono ordinate lessicograficamente). Allora per \cref{MonotoneMisurabili} $f$ è misurabile.
	
	Inoltre l'immagine di $f$ è un insieme trascurabile, infatti questa coincide con i numeri tra $0$ e $1$ che si scrivono unicamente usando cifre $0,1$ in base $3$ e questo è facile dimostrare che è trascurabile (esercizio per il lettore).
	
	Per \cref{InsiemeVitali} esiste $A\subseteq \co{0}{1}$ che non sia misurabile.
	Sia $B=f(A)$.
	
	Poichè $f$ è strettamente crescente è in particolare iniettiva e perciò $A=f^{-1}(B)$.
	Allora la \cref{CounterImgMis} ci assicura che $B$ non appartiene ai Boreliani, altrimenti la sua controimmagine sarebbe misurabile. 
	Infine $B$ è sottoinsieme di $\co01$, che è trascurabile, perciò per la completezza della misura di Lebesgue $B$ è misurabile.
	
	Allora, unendo quanto detto, abbiamo che $B$ è un misurabile non Boreliano come voluto.
\end{proof}



\begin{definition}
	Una funzione $\simp:X \rightarrow \Rbar$ con dominio lo spazio di misura $(X,\A,\mu)$ si dice semplice se è combinazione lineare di
	funzioni caratteristiche di insiemi misurabili.
\end{definition}
\begin{remark}
	È immediato che le funzioni semplici sono misurabili.
\end{remark}
\begin{proof}
	Discende da \cref{CarMis} e \cref{AlgMis}.
\end{proof}


\begin{proposition}
	\label{SupMis}
	Sia $\{f_n\}_{n\in \N}$ una famiglia di funzioni misurabili definite dallo spazio di misura $(X,\A,\mu)$ a $\Rbar$.
	Allora $F:X\rightarrow \Rbar$ definita da $F(x)=\sup\{f_n(x):n\in \N\}$ è misurabile.
\end{proposition}
\begin{proof}
	Consideriamo il sovralivello della funzione $F$: $\{F>a\}=\bigcup_{n\in \N}\{f_n>a\}$, ma allora $\{F>a\}\in \A$ per le proprietà 
	di chiusura della \sigalg.
\end{proof}

\begin{remark}
	\label{LimMis}
	Quest'ultima proposizione ha alcune notevoli conseguenze immediate:
	\begin{enumerate}
		\item $\inf$ di una famiglia numerabile di misurabili è misurabile;\label{LM:inf}
		\item $\limsup$ e $\liminf$ di una famiglie numerabili di misurabili sono misurabili;\label{LM:lim_infsup}
		\item limite puntuale di funzioni misurabili è misurabile.\label{LM:lim}
	\end{enumerate}
\end{remark}
\begin{proof}
	\begin{description}
		\item[\ref{LM:inf}] Per l'$\inf$ basta notare che $\inf\{f_n\}=-\sup\{-f_n\}$, quindi è misurabile per \cref{SupMis};
		\item[\ref{LM:lim_infsup}] per definizione, $\limsup\{f_n\}$ e $\liminf\{f_n\}$ sono rispettivamente
			$\lim_n\{\sup\{f_n\}\}=\inf\{\sup\{f_n\}\}$ e
			$\lim_n\{\inf\{f_n\}\}=\sup\{\inf\{f_n\}\}$, quindi sono funzioni misurabili per il punto precedente;
		\item[\ref{LM:lim}] infine se esiste il limite $\lim_n\{f_n\}$ allora
			$\liminf\{f_n\}=\limsup\{f_n\}=\lim_n\{f_n\}$, pertanto è misurabile per il punto precedente.
	\end{description}
\end{proof}

\begin{proposition}
	\label{LimSemMis}
	Sia $f:X \rightarrow \Rbar$ una funzione con dominio lo spazio di misura $(X,\A,\mu)$.
	Allora $f$ è misurabile se e solo se esiste una successione di funzioni semplici $\simp_n$ che converge puntualmente a $f$.
\end{proposition}
\begin{proof}
	Il se è mostrato in \cref{LimMis}.
	
	Per il solo se facciamo vedere che la seguente successione converge puntualmente a $f$:
	\[
		\simp_n(x) =
		\left\{ \begin{array}{ll}
			n &\qquad se\ f(x)>n;\\
			\frac{k}{2^n} &\qquad se\ \frac{k}{2^n}<f(x)\leq \frac{k+1}{2^n} \qquad k=-n2^n,-n2^n+1,\dots,n2^n;\\
			-n &\qquad se\ f(x)\leq-n;
		\end{array} \right.\ .
	\]
	Prima di tutto abbiamo 
	\[\simp_n=
		n\chi_{\{f>n\}}+
		\sum_{k=-n2^n}^{n2^n}\frac{k}{2^n}\chi_{\left\{ \frac{k}{2^n}<f\leq \frac{k+1}{2^n} \right\}}
		-n\chi_{\{f<-n\}},
	\]
	che mostra che le $\simp_n$ sono funzioni semplici.
	
	Per mostrare la convergenza puntuale distinguiamo $f(x)$ a seconda che sia un numero finito o meno:
	nel primo caso abbiamo che $|f(x)-\simp_n(x)|\leq \frac{1}{2^n}$ definitivamente, cioè $\forall n\geq |f(x)|$,
	nel secondo caso $\simp_n(x)=\pm n\rightarrow \pm\infty = f(x)$;
	quindi $\simp_n(x)\rightarrow f(x)$, $\forall x\in X$.
\end{proof}

\begin{definition}
	Una funzione $f$ definita su $(X,\A,\mu)$ si dice positiva se assume solo valori maggiori o uguali a 0.
\end{definition}


\begin{corollary}\label{LimSemCrescMis}
	Sia $f:X\rightarrow \Rbar$ misurabile e positiva su $(X,\A,\mu)$, allora esiste una successione crescente di funzioni semplici e positive $(\simp_n)$ che converge puntalmente a $f$.
\end{corollary}
\begin{proof}
	Costruendo le $\simp_n$ come in \cref{LimSemMis}, se $f$ è positiva otteniamo facilmente che le $\simp_n$ sono anche crescenti, da cui la tesi.
\end{proof}

